# Emerging Threats 
#
# This distribution may contain rules under two different licenses. 
#
#  Rules with sids 1 through 3464, and 100000000 through 100000908 are under the GPLv2.
#  A copy of that license is available at http://www.gnu.org/licenses/gpl-2.0.html
#
#  Rules with sids 2000000 through 2799999 are from Emerging Threats and are covered under the BSD License 
#  as follows:
#
#*************************************************************
#  Copyright (c) 2003-2021, Emerging Threats
#  All rights reserved.
#  
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the 
#  following conditions are met:
#  
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following 
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the 
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived 
#    from this software without specific prior written permission.
#  
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES, 
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR 
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE 
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
#
#*************************************************************
#
#
#
#

# This Ruleset is EmergingThreats Open optimized for suricata-5.0-enhanced.

#alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 IPv6 Inbound Connect Request (Windows Source)"; dsize:10<>23; flow:established,to_server; content:"|05 01 00 04|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003284; classtype:protocol-command-decode; sid:2003284; rev:5; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

#alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 IPv6 Inbound Connect Request (Linux Source)"; dsize:10<>23; flow:established,to_server; content:"|05 01 00 04|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003285; classtype:protocol-command-decode; sid:2003285; rev:5; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

#alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Bind Inbound (Windows Source)"; dsize:9<>18; flow:established,to_server; content:"|04 02|"; depth:2; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003288; classtype:protocol-command-decode; sid:2003288; rev:5; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

#alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Bind Inbound (Linux Source)"; dsize:9<>18; flow:established,to_server; content:"|04 02|"; depth:2; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003289; classtype:protocol-command-decode; sid:2003289; rev:5; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

#alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Bind Inbound (Linux Source)"; dsize:10; flow:established,to_server; content:"|05 02 00 01|"; depth:4; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003290; classtype:protocol-command-decode; sid:2003290; rev:5; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

#alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Bind Inbound (Windows Source)"; dsize:10; flow:established,to_server; content:"|05 02 00 01|"; depth:4; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003291; classtype:protocol-command-decode; sid:2003291; rev:5; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAVA - Java Class Download By Vulnerable Client"; flow:from_server,established; flowbits:isset,ET.http.javaclient.vulnerable; content:"|0D 0A 0D 0A CA FE BA BE|"; classtype:trojan-activity; sid:2014475; rev:6; metadata:created_at 2012_04_04, updated_at 2012_04_04;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAVA - Java Class Download"; flow:from_server,established; flowbits:isnotset,ET.http.javaclient.vulnerable; flowbits:isset,ET.http.javaclient; content:"|0D 0A 0D 0A CA FE BA BE|"; classtype:trojan-activity; sid:2014474; rev:6; metadata:created_at 2012_04_04, updated_at 2012_04_04;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE - OSX Executable Download - Intel Arch"; flow:established,to_client; content:"|0D 0A 0D 0A CE FA ED FE|"; content:"__TEXT"; distance:0; classtype:misc-activity; sid:2014516; rev:4; metadata:created_at 2012_04_06, updated_at 2012_04_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE - OSX Executable Download - PowerPC Arch"; flow:established,to_client; content:"|0D 0A 0D 0A FE ED FA CE|"; content:"__TEXT"; distance:0; classtype:misc-activity; sid:2014517; rev:4; metadata:created_at 2012_04_06, updated_at 2012_04_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE - OSX Executable Download - Multi Arch w/PowerPC"; flow:established,to_client; content:"|0D 0A 0D 0A CA FE BA BE|"; content:"|FE ED FA CE|"; distance:0; content:"__TEXT"; distance:0; classtype:misc-activity; sid:2014515; rev:4; metadata:created_at 2012_04_06, updated_at 2012_04_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE - OSX Disk Image Download"; flow:established,to_client; content:"|0D 0A 0D 0A|"; content:"<plist version="; distance:0; content:"Apple_partition_map"; distance:0; content:"Apple_HFS"; distance:0; classtype:misc-activity; sid:2014518; rev:5; metadata:created_at 2012_04_06, updated_at 2012_04_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE Download With Content Type Specified As Empty"; flow:established,to_client; content:"Content-Type|3A 20 0D 0A|"; content:"|0d 0a 0d 0a|"; distance:0; content:"MZ"; within:2; isdataat:80,relative; content:"This program "; distance:0; content:"PE|00|"; distance:0; reference:md5,d51218653323e48672023806f6ace26b; classtype:trojan-activity; sid:2014567; rev:5; metadata:created_at 2012_04_16, updated_at 2012_04_16;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Potential Malicious PDF (EmbeddedFiles) improper case"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"/EmbeddedFiles"; within:128; nocase; content:!"/EmbeddedFiles"; distance:-14; within:14; reference:url,blog.didierstevens.com/2009/07/01/embedding-and-hiding-files-in-pdf-documents/; classtype:trojan-activity; sid:2014575; rev:4; metadata:created_at 2012_04_16, updated_at 2012_04_16;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Packed Executable Download"; flow:established,to_client; content:"|0d 0a 0d 0a|MZ"; isdataat:100,relative; content:"This program "; distance:0; content:"PE|00 00|"; distance:0; content:!"data"; within:400; content:!"text"; within:400; content:!"rsrc"; within:400; classtype:misc-activity; sid:2014819; rev:3; metadata:created_at 2012_05_30, updated_at 2012_05_30;)

alert ftp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO .exe File requested over FTP"; flow:established,to_server; dsize:>10; content:"RETR"; depth:4; content:".exe|0d 0a|"; distance:0; pcre:"/^RETR\s+[^\r\n]+?\x2eexe\r?$/m"; classtype:policy-violation; sid:2014906; rev:2; metadata:created_at 2012_06_15, updated_at 2012_06_15;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PDF embedded in XDP file (Possibly Malicious)"; flow:established, to_client; content:"<xdp|3a|xdp"; nocase; fast_pattern; content:"<pdf"; nocase; distance:0; pcre:"/\<xdp\x3axdp(\s+[^\>]*)?\>((?!\<\/xdp[^\>]*\>).)*?\<pdf/si"; reference:url,blog.9bplus.com/av-bypass-for-malicious-pdfs-using-xdp; classtype:misc-attack; sid:2014926; rev:3; metadata:created_at 2012_06_20, updated_at 2012_06_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Compressed Executable SZDD Compress.exe Format Over HTTP"; flow:established,to_client; content:"|0d 0a 0d 0a|SZDD"; content:"PE|00 00|"; distance:0; reference:url,blog.fireeye.com/research/2012/07/inside-customized-threat.html#more; reference:url,www.cabextract.org.uk/libmspack/doc/szdd_kwaj_format.html; classtype:bad-unknown; sid:2015004; rev:3; metadata:created_at 2012_07_03, updated_at 2012_07_03;)

#alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"ET INFO FTP STOR to External Network"; flow:established,to_server; content:"STOR "; depth:5; classtype:misc-activity; sid:2015016; rev:2; metadata:created_at 2012_07_04, updated_at 2012_07_04;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PDF Using CCITTFax Filter"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/CCITTFaxDecode"; distance:0; reference:url,nakedsecurity.sophos.com/2012/04/05/ccittfax-pdf-malware/; reference:url,blog.fireeye.com/research/2012/07/analysis-of-a-different-pdf-malware.html#more; classtype:bad-unknown; sid:2015561; rev:2; metadata:created_at 2012_08_02, former_category INFO, updated_at 2017_06_01;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possible URL List or Clickfraud URLs Delivered To Client"; flow:established,from_server; content:"|0d 0a 0d 0a|http|3a|//"; content:"|7C|http|3a|//"; distance:0; content:"|0D 0A|http|3a|//"; distance:0; content:"|7C|http|3a|//"; distance:0; classtype:trojan-activity; sid:2014149; rev:4; metadata:created_at 2012_01_24, updated_at 2012_01_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAVA - document.createElement applet"; flow:established,to_client; file_data; content:"document.createElement"; nocase; content:"applet"; nocase; fast_pattern; within:10; classtype:misc-activity; sid:2015707; rev:2; metadata:created_at 2012_09_18, updated_at 2012_09_18;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO DoSWF Flash Encryption Banner"; flow:to_client,established; file_data; content:"FWS"; within:3; content:"DoSWF"; distance:0; classtype:attempted-user; sid:2015704; rev:6; metadata:created_at 2012_09_18, former_category CURRENT_EVENTS, updated_at 2012_09_18;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE CheckRemoteDebuggerPresent (Used in Malware Anti-Debugging)"; flow:established,to_client; file_data; flowbits:isset,ET.http.binary; content:"CheckRemoteDebuggerPresent"; classtype:misc-activity; sid:2015745; rev:2; metadata:created_at 2012_09_28, updated_at 2012_09_28;)

alert udp $HOME_NET 5355 -> any any (msg:"ET INFO LLNMR query response to wpad"; content:"|80 00 00 01 00 01|"; offset:2; depth:6; content:"|04|wpad|00 00 01 00 01 04|wpad|00 00 01 00 01|"; distance:0; isdataat:7,relative; classtype:misc-activity; sid:2015842; rev:2; metadata:created_at 2012_10_25, updated_at 2012_10_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PDF /FlateDecode and PDF version 1.0"; flow:established,from_server; file_data; content:"%PDF-1.0"; fast_pattern; within:8; content:"/FlateDecode"; distance:0; classtype:trojan-activity; sid:2015954; rev:2; metadata:created_at 2012_11_29, updated_at 2012_11_29;)

#alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"ET INFO DNS Query for Suspicious .com.ru Domain"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|com|02|ru|00|"; fast_pattern; nocase; distance:0; reference:url,sign.kaffenews.com/?p=104; classtype:bad-unknown; sid:2011407; rev:3; metadata:created_at 2010_09_28, former_category HUNTING, updated_at 2010_09_28;)

#alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"ET INFO DNS Query for Suspicious .com.cn Domain"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|03|com|02|cn|00|"; fast_pattern; nocase; distance:0; reference:url,sign.kaffenews.com/?p=104; classtype:bad-unknown; sid:2011408; rev:3; metadata:created_at 2010_09_28, former_category HUNTING, updated_at 2010_09_28;)

#alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"ET INFO DNS Query for Suspicious .co.kr Domain"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|co|02|kr|00|"; fast_pattern; nocase; distance:0; reference:url,sign.kaffenews.com/?p=104; classtype:bad-unknown; sid:2011411; rev:3; metadata:created_at 2010_09_28, former_category HUNTING, updated_at 2010_09_28;)

alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"ET INFO MySQL Database Query Version OS compile"; flow:to_server,established; content:"|03|"; offset:3; depth:4; content:"select |40 40|version_compile_os"; nocase; pcre:"/SELECT @@version_compile_os\s*?\x3b/i"; classtype:misc-activity; sid:2015994; rev:2; metadata:created_at 2012_12_06, updated_at 2012_12_06;)

alert icmp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO PTUNNEL OUTBOUND"; itype:8; icode:0; content:"|D5 20 08 80|"; depth:4; reference:url,github.com/madeye/ptunnel; reference:url,cs.uit.no/~daniels/PingTunnel/#protocol; classtype:protocol-command-decode; sid:2016145; rev:2; metadata:created_at 2013_01_03, updated_at 2013_01_03;)

alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PTUNNEL INBOUND"; itype:0; icode:0; content:"|D5 20 08 80|"; depth:4; reference:url,github.com/madeye/ptunnel; reference:url,cs.uit.no/~daniels/PingTunnel/#protocol; classtype:protocol-command-decode; sid:2016146; rev:3; metadata:created_at 2013_01_03, updated_at 2013_01_03;)

alert udp $HOME_NET 1900 -> any any (msg:"ET INFO UPnP Discovery Search Response vulnerable UPnP device 3"; content:"Portable SDK for UPnP devices"; pcre:"/^Server\x3a[^\r\n]*Portable SDK for UPnP devices(\/?\s*$|\/1\.([0-5]\..|8\.0.|(6\.[0-9]|6\.1[0-7])))/m"; reference:url,community.rapid7.com/community/infosec/blog/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play; reference:url,upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf; reference:cve,2012-5958; reference:cve,2012-5959; classtype:successful-recon-limited; sid:2016304; rev:2; metadata:created_at 2013_01_30, updated_at 2013_01_30;)

alert udp $HOME_NET 1900 -> any any (msg:"ET INFO UPnP Discovery Search Response vulnerable UPnP device 2"; content:"Intel SDK for UPnP devices"; pcre:"/^Server\x3a[^\r\n]*Intel SDK for UPnP devices/mi"; reference:url,community.rapid7.com/community/infosec/blog/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play; reference:url,upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf; reference:cve,2012-5958; reference:cve,2012-5959; classtype:successful-recon-limited; sid:2016303; rev:4; metadata:created_at 2013_01_30, updated_at 2013_01_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAVA - ClassID"; flow:established,to_client; file_data; content:"8AD9C840-044E-11D1-B3E9-00805F499D93"; classtype:misc-activity; sid:2016360; rev:2; metadata:created_at 2013_02_07, updated_at 2013_02_07;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAVA - ClassID"; flow:established,to_client; file_data; content:"CAFEEFAC-00"; content:"-FFFF-ABCDEFFEDCBA"; distance:7; within:18; classtype:misc-activity; sid:2016361; rev:2; metadata:created_at 2013_02_07, updated_at 2013_02_07;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO MPEG Download Over HTTP (1)"; flow:established,to_client; file_data; content:"|00 00 01 ba|"; depth:4; flowbits:set,ET.mpeg.HTTP; flowbits:noalert; classtype:not-suspicious; sid:2016404; rev:3; metadata:created_at 2013_02_12, updated_at 2013_02_12;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Java Serialized Data via vulnerable client"; flow:established,from_server; flowbits:isset,ET.http.javaclient.vulnerable; file_data; content:"|ac ed|"; within:2; flowbits:set,et.exploitkitlanding; classtype:trojan-activity; sid:2016502; rev:2; metadata:created_at 2013_02_26, updated_at 2013_02_26;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Java Serialized Data"; flow:established,from_server; flowbits:isset,ET.http.javaclient; file_data; content:"|ac ed|"; within:2; flowbits:set,et.exploitkitlanding; classtype:trojan-activity; sid:2016503; rev:2; metadata:created_at 2013_02_26, updated_at 2013_02_26;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO file possibly containing Serialized Data file"; flow:to_client,established; file_data; content:"PK"; within:2; content:".serPK"; flowbits:isset,ET.http.javaclient.vulnerable; classtype:trojan-activity; sid:2016505; rev:2; metadata:created_at 2013_02_26, updated_at 2013_02_26;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Serialized Java Applet (Used by some EKs in the Wild)"; flow:established,from_server; file_data; content:"<applet"; nocase; content:"object"; distance:0; nocase; pcre:"/^[\r\n\s]*=[\r\n\s]*[\x22\x27][^\x22\x27]+\.ser[\x22\x27]/Ri"; classtype:exploit-kit; sid:2016494; rev:5; metadata:created_at 2013_02_25, former_category INFO, updated_at 2013_02_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Executable Retrieved With Minimal HTTP Headers - Potential Second Stage Download"; flowbits:isset,min.gethttp; flow:established,to_client; file_data; content:"MZ"; within:2; content:"PE|00 00|"; distance:0; classtype:bad-unknown; sid:2016538; rev:3; metadata:created_at 2013_03_06, updated_at 2013_03_06;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Old/Rare PDF Generator Acrobat Web Capture [8-9].0"; flow:from_server,established; flowbits:isset,ET.pdf.in.http; file_data; content:"Acrobat Web Capture "; pcre:"/^[8-9]\.0/R"; reference:url,carnal0wnage.attackresearch.com/2013/03/apt-pdfs-and-metadata-extraction.html; classtype:not-suspicious; sid:2016646; rev:3; metadata:created_at 2013_03_22, updated_at 2013_03_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Old/Rare PDF Generator Adobe LiveCycle Designer ES 8.2"; flow:from_server,established; flowbits:isset,ET.pdf.in.http; file_data; content:"Adobe LiveCycle Designer ES 8.2"; fast_pattern:11,20; reference:url,carnal0wnage.attackresearch.com/2013/03/apt-pdfs-and-metadata-extraction.html; classtype:not-suspicious; sid:2016647; rev:3; metadata:created_at 2013_03_22, updated_at 2013_03_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Old/Rare PDF Generator Python PDF Library"; flow:from_server,established; file_data; flowbits:isset,ET.pdf.in.http; content:"Python PDF Library - http|3a|//pybrary.net/pyPdf/"; reference:url,carnal0wnage.attackresearch.com/2013/03/apt-pdfs-and-metadata-extraction.html; classtype:not-suspicious; sid:2016648; rev:3; metadata:created_at 2013_03_22, updated_at 2013_03_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Old/Rare PDF Generator Acrobat Distiller 9.0.0 (Windows)"; flow:from_server,established; flowbits:isset,ET.pdf.in.http; file_data; content:"Acrobat Distiller 9.0.0 (Windows)"; fast_pattern:3,20; reference:url,carnal0wnage.attackresearch.com/2013/03/apt-pdfs-and-metadata-extraction.html; classtype:not-suspicious; sid:2016649; rev:2; metadata:created_at 2013_03_22, updated_at 2013_03_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Old/Rare PDF Generator Acrobat Distiller 6.0.1 (Windows)"; flow:from_server,established; flowbits:isset,ET.pdf.in.http; file_data; content:"Acrobat Distiller 6.0.1 (Windows)"; fast_pattern:3,20; reference:url,carnal0wnage.attackresearch.com/2013/03/apt-pdfs-and-metadata-extraction.html; classtype:not-suspicious; sid:2016650; rev:2; metadata:created_at 2013_03_22, updated_at 2013_03_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Old/Rare PDF Generator pdfeTeX-1.21a"; flow:from_server,established; flowbits:isset,ET.pdf.in.http; file_data; content:"pdfeTeX-1.21a"; reference:url,carnal0wnage.attackresearch.com/2013/03/apt-pdfs-and-metadata-extraction.html; classtype:not-suspicious; sid:2016651; rev:2; metadata:created_at 2013_03_22, updated_at 2013_03_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Old/Rare PDF Generator Adobe Acrobat 9.2.0"; flow:from_server,established; flowbits:isset,ET.pdf.in.http; file_data; content:"Adobe Acrobat 9.2.0"; reference:url,carnal0wnage.attackresearch.com/2013/03/apt-pdfs-and-metadata-extraction.html; classtype:not-suspicious; sid:2016652; rev:2; metadata:created_at 2013_03_22, updated_at 2013_03_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Old/Rare PDF Generator Adobe PDF Library 9.0"; flow:from_server,established; flowbits:isset,ET.pdf.in.http; file_data; content:"Adobe PDF Library 9.0"; reference:url,carnal0wnage.attackresearch.com/2013/03/apt-pdfs-and-metadata-extraction.html; classtype:not-suspicious; sid:2016653; rev:2; metadata:created_at 2013_03_22, updated_at 2013_03_22;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PDF - Acrobat Enumeration - var PDFObject"; flow:established,to_client; file_data; content:"var PDFObject="; classtype:misc-activity; sid:2016766; rev:2; metadata:created_at 2013_04_18, updated_at 2013_04_18;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE - SCR in PKZip Compressed Data Download"; flow:established,to_client; file_data; content:"PK"; within:2; content:".scr"; fast_pattern:only; nocase; classtype:bad-unknown; sid:2016767; rev:3; metadata:created_at 2013_04_18, updated_at 2013_04_18;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JJEncode Encoded Script"; flow:established,from_server; file_data; content:"$$$$|3a|(![]+|22 22|)["; pcre:"/^(?P<global_var>((?!(\]\,__\$\x3a\+\+)).)+)]\,__\$\x3a\+\+(?P=global_var)/R"; classtype:bad-unknown; sid:2017127; rev:2; metadata:created_at 2013_07_11, updated_at 2013_07_11;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS Java Request to DtDNS Dynamic DNS Domain"; flow:to_server,established; content:"Java/1."; http_user_agent; pcre:"/^Host\x3a\x20[^\r\n]+\.(?:(?:b(?:bsindex|0ne)|chatnook|gotgeeks|3d-game|4irc)\.com|s(?:(?:cieron|uroot)\.com|lyip\.(?:com|net))|d(?:arktech\.org|eaftone\.com|tdns\.net)|e(?:towns\.(?:net|org)|ffers\.com)|flnet\.org)(\x3a\d{1,5})?\r$/Hmi"; classtype:bad-unknown; sid:2016584; rev:4; metadata:created_at 2013_03_15, former_category HUNTING, updated_at 2013_03_15;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS Java Request to cd.am Dynamic DNS Domain"; flow:to_server,established; content:"Java/1."; http_user_agent; content:"cd.am"; http_header; nocase; pcre:"/^Host\x3a\x20[^\r\n]+\.cd\.am(\x3a\d{1,5})?\r$/Hmi"; classtype:bad-unknown; sid:2016595; rev:6; metadata:created_at 2013_03_20, former_category HUNTING, updated_at 2013_03_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JNLP embedded file"; flow:established,to_client; file_data; content:"jnlp"; content:"PD94bWwgdmVyc2lvbj0"; distance:0; classtype:bad-unknown; sid:2017197; rev:3; metadata:created_at 2013_07_26, updated_at 2013_07_26;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String 1"; flow:established,from_server; file_data; content:"|22|e|22|+|22|val|22|"; classtype:trojan-activity; sid:2017206; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String 2"; flow:established,from_server; file_data; content:"|22|ev|22|+|22|al|22|"; classtype:trojan-activity; sid:2017207; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String 3"; flow:established,from_server; file_data; content:"|22|e|22|+|22|v|22|+|22|al|22|"; classtype:trojan-activity; sid:2017208; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String 4"; flow:established,from_server; file_data; content:"|22|e|22|+|22|v|22|+|22|a|22|+|22|l|22|"; classtype:trojan-activity; sid:2017209; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String 5"; flow:established,from_server; file_data; content:"|22|ev|22|+|22|a|22|+|22|l|22|"; classtype:trojan-activity; sid:2017210; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String 6"; flow:established,from_server; file_data; content:"|22|e|22|+|22|va|22|+|22|l|22|"; classtype:trojan-activity; sid:2017211; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String (Single Q) 1"; flow:established,from_server; file_data; content:"|27|e|27|+|27|val|27|"; classtype:trojan-activity; sid:2017212; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String (Single Q) 2"; flow:established,from_server; file_data; content:"|27|ev|27|+|27|al|27|"; classtype:trojan-activity; sid:2017213; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String (Single Q) 3"; flow:established,from_server; file_data; content:"|27|eva|27|+|27|l|27|"; classtype:trojan-activity; sid:2017214; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String (Single Q) 4"; flow:established,from_server; file_data; content:"|27|e|27|+|27|v|27|+|27|al|27|"; classtype:trojan-activity; sid:2017215; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String (Single Q) 5"; flow:established,from_server; file_data; content:"|27|e|27|+|27|v|27|+|27|a|27|+|27|l|27|"; classtype:trojan-activity; sid:2017216; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String (Single Q) 7"; flow:established,from_server; file_data; content:"|27|e|27|+|27|va|27|+|27|l|27|"; classtype:trojan-activity; sid:2017218; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String (Single Q) 6"; flow:established,from_server; file_data; content:"|27|ev|27|+|27|a|27|+|27|l|27|"; classtype:trojan-activity; sid:2017217; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Eval String 7"; flow:established,from_server; file_data; content:"|22|eva|22|+|22|l|22|"; classtype:trojan-activity; sid:2017219; rev:2; metadata:created_at 2013_07_27, updated_at 2013_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 1"; flow:established,from_server; file_data; content:"|27|s|27|+|27|plit|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017220; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 2"; flow:established,from_server; file_data; content:"|27|sp|27|+|27|lit|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017221; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 3"; flow:established,from_server; file_data; content:"|27|s|27|+|27|p|27|+|27|lit|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017222; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 4"; flow:established,from_server; file_data; content:"|27|spl|27|+|27|it|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017223; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 5"; flow:established,from_server; file_data; content:"|27|sp|27|+|27|l|27|+|27|it|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017224; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 6"; flow:established,from_server; file_data; content:"|27|s|27|+|27|pl|27|+|27|it|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017225; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 7"; flow:established,from_server; file_data; content:"|27|s|27|+|27|p|27|+|27|l|27|+|27|it|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017226; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 8"; flow:established,from_server; file_data; content:"|27|spli|27|+|27|t|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017227; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 9"; flow:established,from_server; file_data; content:"|27|sp|27|+|27|l|27|+|27|i|27|+|27|t|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017228; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 10"; flow:established,from_server; file_data; content:"|27|sp|27|+|27|li|27|+|27|t|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017229; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 11"; flow:established,from_server; file_data; content:"|27|spl|27|+|27|i|27|+|27|t|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017230; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 12"; flow:established,from_server; file_data; content:"|27|s|27|+|27|pli|27|+|27|t|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017231; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Single Q) 13"; flow:established,from_server; file_data; content:"|27|s|27|+|27|p|27|+|27|l|27|+|27|i|27|+|27|t|27|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017232; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 1"; flow:established,from_server; file_data; content:"|22|s|22|+|22|plit|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017233; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 2"; flow:established,from_server; file_data; content:"|22|sp|22|+|22|lit|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017234; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 3"; flow:established,from_server; file_data; content:"|22|s|22|+|22|p|22|+|22|lit|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017235; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 4"; flow:established,from_server; file_data; content:"|22|spl|22|+|22|it|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017236; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 5"; flow:established,from_server; file_data; content:"|22|sp|22|+|22|l|22|+|22|it|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017237; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 6"; flow:established,from_server; file_data; content:"|22|s|22|+|22|pl|22|+|22|it|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017238; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 7"; flow:established,from_server; file_data; content:"|22|s|22|+|22|p|22|+|22|l|22|+|22|it|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017239; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 8"; flow:established,from_server; file_data; content:"|22|spli|22|+|22|t|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017240; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 9"; flow:established,from_server; file_data; content:"|22|sp|22|+|22|l|22|+|22|i|22|+|22|t|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017241; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 10"; flow:established,from_server; file_data; content:"|22|sp|22|+|22|li|22|+|22|t|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017242; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 11"; flow:established,from_server; file_data; content:"|22|spl|22|+|22|i|22|+|22|t|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017243; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 12"; flow:established,from_server; file_data; content:"|22|s|22|+|22|pli|22|+|22|t|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017244; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated Split String (Double Q) 13"; flow:established,from_server; file_data; content:"|22|s|22|+|22|p|22|+|22|l|22|+|22|i|22|+|22|t|22|"; nocase; flowbits:set,ET.JS.Obfus.Func; classtype:bad-unknown; sid:2017245; rev:2; metadata:created_at 2013_07_30, updated_at 2013_07_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Microsoft Script Encoder Encoded File"; flow:established,from_server; file_data; content:"#@~^"; within:4; classtype:trojan-activity; sid:2017282; rev:3; metadata:created_at 2013_08_07, updated_at 2013_08_07;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Iframe For IP Address Site"; flow:established,to_client; file_data; content:"iframe src=|22|http|3A|//"; nocase; distance:0; pcre:"/^\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}[^\r\n]*\x3C\x2Fiframe\x3E/Ri"; classtype:bad-unknown; sid:2017342; rev:3; metadata:created_at 2013_08_19, updated_at 2013_08_19;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO SUSPCIOUS Non-standard base64 charset used for encoding"; flow:established,from_server; file_data; content:" & 15) << 4)"; fast_pattern; content:"(|22|"; content:!"|22|"; within:65; content:"|22|"; distance:65; within:1; content:!"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"; distance:-66; within:62; content:!"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"; distance:-66; within:62; content:!"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"; distance:-66; within:62; content:!"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"; distance:-66; within:62; content:!"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz"; distance:-66; within:62; content:!"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"; distance:-66; within:62; flowbits:set,et.exploitkitlanding; classtype:bad-unknown; sid:2017364; rev:7; metadata:created_at 2013_08_21, updated_at 2013_08_21;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Probably Evil Long Unicode string only string and unescape 1"; flow:established,from_server; file_data; content:"unescape"; content:"|22|%u"; content:!"|22|"; within:120; pcre:"/^[a-f0-9]{4}([\%\\]u[a-f0-9]{4}){20}/Ri"; classtype:trojan-activity; sid:2017499; rev:2; metadata:created_at 2013_09_20, former_category CURRENT_EVENTS, updated_at 2013_09_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Probably Evil Long Unicode string only string and unescape 2"; flow:established,from_server; file_data; content:"unescape"; content:"|27|%u"; nocase; content:!"|27|"; within:120; pcre:"/^[a-f0-9]{4}([\%\\]u[a-f0-9]{4}){20}/Ri"; classtype:trojan-activity; sid:2017500; rev:2; metadata:created_at 2013_09_20, former_category CURRENT_EVENTS, updated_at 2013_09_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Probably Evil Long Unicode string only string and unescape 3"; flow:established,from_server; file_data; content:"unescape"; content:"|22 5f|u"; nocase; pcre:"/^[a-f0-9]{4}([\%\\]u[a-f0-9]{4}){20}/Ri"; classtype:trojan-activity; sid:2017501; rev:2; metadata:created_at 2013_09_20, former_category CURRENT_EVENTS, updated_at 2013_09_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Probably Evil Long Unicode string only string and unescape 3"; flow:established,from_server; file_data; content:"unescape"; content:"|27 5f|u"; nocase; content:!"|27|"; within:100; pcre:"/^[a-f0-9]{4}([\%\\]u[a-f0-9]{4}){20}/Ri"; classtype:trojan-activity; sid:2017502; rev:2; metadata:created_at 2013_09_20, former_category CURRENT_EVENTS, updated_at 2013_09_20;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated fromCharCode"; flow:established,from_server; file_data; content:"|22|f"; nocase; content:!"romCharcode"; nocase; within:11; pcre:"/^(?:\x22\s*?\+\s*?\x22)?r(?:\x22\s*?\+\s*?\x22)?o(?:\x22\s*?\+\s*?\x22)?m(?:\x22\s*?\+\s*?\x22)?C(?:\x22\s*?\+\s*?\x22)?h(?:\x22\s*?\+\s*?\x22)?a(?:\x22\s*?\+\s*?\x22)?r(?:\x22\s*?\+\s*?\x22)?c(?:\x22\s*?\+\s*?\x22)?o(?:\x22\s*?\+\s*?\x22)?d(?:\x22\s*?\+\s*?\x22)?e/Ri"; classtype:bad-unknown; sid:2017565; rev:4; metadata:created_at 2013_10_08, updated_at 2013_10_08;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Obfuscated fromCharCode"; flow:established,from_server; file_data; content:"|27|f"; nocase; content:!"romCharcode"; nocase; within:11; pcre:"/^(?:\x27\s*?\+\s*?\x27)?r(?:\x27\s*?\+\s*?\x27)?o(?:\x27\s*?\+\s*?\x27)?m(?:\x27\s*?\+\s*?\x27)?C(?:\x27\s*?\+\s*?\x27)?h(?:\x27\s*?\+\s*?\x27)?a(?:\x27\s*?\+\s*?\x27)?r(?:\x27\s*?\+\s*?\x27)?c(?:\x27\s*?\+\s*?\x27)?o(?:\x27\s*?\+\s*?\x27)?d(?:\x27\s*?\+\s*?\x27)?e/Ri"; classtype:bad-unknown; sid:2017566; rev:5; metadata:created_at 2013_10_08, updated_at 2013_10_08;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Zip File"; flow:established,from_server; file_data; content:"PK|03 04|"; within:4; flowbits:set,et.http.PK; flowbits:noalert; classtype:misc-activity; sid:2017669; rev:5; metadata:created_at 2013_11_06, updated_at 2013_11_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Java Downloading Archive flowbit no alert"; flow:established,from_server; flowbits:isset,ET.http.javaclient; file_data; content:"PK"; within:2; flowbits:set,et.JavaArchiveOrClass; flowbits:noalert; classtype:misc-activity; sid:2017748; rev:6; metadata:created_at 2013_11_25, updated_at 2013_11_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Java Downloading Class flowbit no alert"; flow:established,from_server; flowbits:isset,ET.http.javaclient; file_data; content:"|CA FE BA BE|"; within:4; flowbits:set,et.JavaArchiveOrClass; flowbits:noalert; classtype:misc-activity; sid:2017749; rev:6; metadata:created_at 2013_11_25, updated_at 2013_11_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO InformationCardSigninHelper ClassID (Vulnerable ActiveX Control in CVE-2013-3918)"; flow:established,to_client; file_data; content:"19916E01-B44E-4E31-94A4-4696DF46157B"; nocase; classtype:misc-activity; sid:2017980; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2014_01_17, deployment Perimeter, signature_severity Major, tag ActiveX, updated_at 2016_07_01;)

alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"ET INFO BrowseTor .onion Proxy Service SSL Cert"; flow:established,from_server; content:"|55 04 03|"; content:"|0f|*.browsetor.com"; nocase; distance:1; within:16; classtype:bad-unknown; sid:2018396; rev:4; metadata:attack_target Client_Endpoint, created_at 2014_04_16, deployment Perimeter, former_category CURRENT_EVENTS, signature_severity Major, tag SSL_Malicious_Cert, updated_at 2016_07_01;)

alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"ET INFO Tor2Web .onion Proxy Service SSL Cert (1)"; flow:established,from_server; content:"|55 04 03|"; content:"*.tor2web."; nocase; distance:2; within:10; reference:url,uscyberlabs.com/blog/2013/04/30/tor-exploit-pak/; classtype:trojan-activity; sid:2016806; rev:5; metadata:attack_target Client_Endpoint, created_at 2013_05_02, deployment Perimeter, former_category CURRENT_EVENTS, signature_severity Major, tag SSL_Malicious_Cert, updated_at 2016_07_01;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Potential Common Malicious JavaScript Loop"; flow:established,to_client; content:"for("; content:"|3B|"; within:20; content:">=0|3B|"; fast_pattern; within:10; content:"--)"; within:10; pcre:"/for\x28[^\x3D\r\n]*[0-9]{1,6}\x2D[0-9]{1,5}\x3B[^\x3D\r\n]\x3E\x3D0\x3B[^\x29\r\n]\x2D\x2D\x29/"; classtype:bad-unknown; sid:2015045; rev:4; metadata:created_at 2012_07_07, updated_at 2012_07_07;)

alert tcp $EXTERNAL_NET [443,$HTTP_PORTS] -> $HOME_NET any (msg:"ET INFO tor2www .onion Proxy SSL cert"; flow:established,from_server; content:"|55 04 03|"; content:"*.tor2www."; nocase; distance:2; within:10; classtype:trojan-activity; sid:2018538; rev:2; metadata:attack_target Client_Endpoint, created_at 2014_06_06, deployment Perimeter, former_category CURRENT_EVENTS, signature_severity Major, tag SSL_Malicious_Cert, updated_at 2016_07_01;)

alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Request obsolete rfc 3489 CHANGE-REQUEST attribute change IP flag false change port flag false)"; dsize:28; content:"|00 01 00 08|"; depth:4; content:"|00 03 00 04 00 00 00 00|"; fast_pattern; distance:16; within:8; threshold: type limit, track by_dst, count 1, seconds 120; reference:url,tools.ietf.org/html/rfc3489; classtype:protocol-command-decode; sid:2018904; rev:6; metadata:created_at 2014_08_07, updated_at 2014_08_07;)

alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Request obsolete rfc 3489 CHANGE-REQUEST attribute change IP flag false change port flag true)"; dsize:28; content:"|00 01 00 08|"; depth:4; content:"|00 03 00 04 00 00 00 02|"; fast_pattern; distance:16; within:8; threshold: type limit, track by_dst, count 1, seconds 120; reference:url,tools.ietf.org/html/rfc3489; classtype:protocol-command-decode; sid:2018905; rev:6; metadata:created_at 2014_08_07, updated_at 2014_08_07;)

alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Request obsolete rfc 3489 CHANGE-REQUEST attribute change IP flag true change port flag false)"; dsize:28; content:"|00 01 00 08|"; depth:4; content:"|00 03 00 04 00 00 00 04|"; fast_pattern; distance:16; within:8; threshold: type limit, track by_dst, count 1, seconds 120; reference:url,tools.ietf.org/html/rfc3489; classtype:protocol-command-decode; sid:2018906; rev:6; metadata:created_at 2014_08_07, updated_at 2014_08_07;)

alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Request obsolete rfc 3489 CHANGE-REQUEST attribute change IP flag true change port flag true)"; dsize:28; content:"|00 01 00 08|"; depth:4; content:"|00 03 00 04 00 00 00 06|"; fast_pattern; distance:16; within:8; threshold: type limit, track by_dst, count 1, seconds 120; reference:url,tools.ietf.org/html/rfc3489; classtype:protocol-command-decode; sid:2018907; rev:5; metadata:created_at 2014_08_07, updated_at 2014_08_07;)

#alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:"ET INFO RuggedCom Banner with MAC"; flow:to_client,established; content:"Rugged Operating System"; content:"Copyright |28|c|29| RuggedCom"; distance:0; content:"MAC Address|3A|"; distance:0; flowbits:set,ET.RUGGED.BANNER; reference:url,www.exploit-db.com/exploits/18779/; reference:url,arstechnica.com/business/news/2012/04/backdoor-in-mission-critical-hardware-threatens-power-traffic-control-systems.ars; classtype:attempted-admin; sid:2014645; rev:3; metadata:created_at 2012_04_28, former_category INFO, updated_at 2012_04_28;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Googlebot User-Agent Outbound (likely malicious)"; flow:to_server,established; content:"Googlebot"; nocase; http_header; pcre:"/^User-Agent\x3a[^\r\n]*?Googlebot/Hmi"; classtype:bad-unknown; sid:2015529; rev:4; metadata:created_at 2012_07_27, updated_at 2012_07_27;)

alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"ET INFO Suspicious Self Signed SSL Certificate to 'My Company Ltd'"; flow:established,from_server; content:"|16 03|"; content:"|0b|"; within:7; content:"My Company Ltd"; classtype:bad-unknown; sid:2013703; rev:3; metadata:attack_target Client_Endpoint, created_at 2011_09_28, deployment Perimeter, signature_severity Major, tag SSL_Malicious_Cert, updated_at 2016_07_01;)

#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Revoked Adobe Code Signing Certificate Seen"; flow:established,to_client; content:"|30 82|"; content:"|a0 03 02 01 02 02 10 15 e5 ac 0a 48 70 63 71 8e 39 da 52 30 1a 04 88 30 0d 06 09 2a 86 48 86 f7 0d 01 01 05 05 00|"; distance:6; within:38; content:"|1e 17 0d|101215000000Z|17 0d|121214235959Z0"; distance:184; within:32; content:"Adobe Systems Incorporated"; distance:66; within:26; reference:url,www.adobe.com/support/security/advisories/apsa12-01.html; classtype:policy-violation; sid:2015743; rev:2; metadata:created_at 2012_09_28, former_category INFO, updated_at 2012_09_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO WinHttpRequest Downloading EXE"; flow:established,from_server; flowbits:isset,et.WinHttpRequest; file_data; content:"MZ"; within:2; byte_jump:4,58,relative,little; content:"PE|00 00|"; distance:-64; within:4; classtype:trojan-activity; sid:2019822; rev:7; metadata:created_at 2014_12_01, former_category CURRENT_EVENTS, updated_at 2014_12_01;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Microsoft Compact Office Document Format File Download"; flow:established,from_server; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; within:8; flowbits:set,et.MCOFF; flowbits:noalert; classtype:misc-activity; sid:2019834; rev:2; metadata:created_at 2014_12_02, updated_at 2014_12_02;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $SSH_PORTS (msg:"ET INFO NetSSH SSH Version String Hardcoded in Metasploit"; flow:established,to_server; content:"SSH-2.0-OpenSSH_5.0|0d 0a|"; depth:21; reference:url,github.com/rapid7/metasploit-framework/blob/master/lib/net/ssh/transport/server_version.rb; classtype:attempted-user; sid:2014925; rev:2; metadata:affected_product Any, attack_target Client_and_Server, created_at 2012_06_20, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, signature_severity Critical, tag Metasploit, updated_at 2016_07_01;)

alert udp $HOME_NET any -> $EXTERNAL_NET 3478 (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Request)"; content:"|00 01|"; depth:2; content:"|21 12 a4 42|"; distance:2; within:4; reference:url,tools.ietf.org/html/rfc5389; classtype:attempted-user; sid:2016149; rev:2; metadata:created_at 2013_01_04, updated_at 2013_01_04;)

alert udp $EXTERNAL_NET 3478 -> $HOME_NET any (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Response)"; content:"|01 01|"; depth:2; content:"|21 12 a4 42|"; distance:2; within:4; reference:url,tools.ietf.org/html/rfc5389; classtype:attempted-user; sid:2016150; rev:2; metadata:created_at 2013_01_04, updated_at 2013_01_04;)

alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Response)"; content:"|01 01 00 44|"; depth:4; content:"|00 01 00 08|"; distance:16; within:4; threshold:type limit, track by_src, count 1, seconds 60; reference:url,tools.ietf.org/html/rfc5389; classtype:protocol-command-decode; sid:2018908; rev:2; metadata:created_at 2014_08_07, updated_at 2014_08_07;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Executable Downloaded from Google Cloud Storage"; flow:established,to_client; content:"x-goog-generation|3a 20|"; http_header; fast_pattern; content:"x-goog-metageneration|3a 20|"; http_header; content:"x-goog-stored-content-encoding|3a 20|"; http_header; content:"x-goog-stored-content-length|3a 20|"; http_header; content:"x-goog-hash|3a 20|"; http_header; file_data; content:"MZ"; within:2; reference:md5,e742e844d0ea55ef9f1c68491c702120; classtype:trojan-activity; sid:2021216; rev:3; metadata:created_at 2015_06_09, updated_at 2015_06_09;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PK/Compressed doc/JAR header"; flow:from_server,established; file_data; content:"|50 4B 03 04|"; depth:4; flowbits:set,ET.zipfile; flowbits:noalert; classtype:misc-activity; sid:2022055; rev:2; metadata:created_at 2015_11_10, updated_at 2015_11_10;)

#alert udp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 UDP Proxy Inbound Connect Request (Linux Source)"; content:"|00 00|"; depth:2; content:"|01|"; offset:3; depth:1; threshold:type both, track by_dst, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003287; classtype:protocol-command-decode; sid:2003287; rev:7; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

#alert udp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 UDP Proxy Inbound Connect Request (Windows Source)"; content:"|00 00|"; depth:2; content:"|01|"; offset:3; depth:1; threshold:type both, track by_dst, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003286; classtype:protocol-command-decode; sid:2003286; rev:8; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Generic HeapSpray Construct"; flow:established,to_client; file_data; content:"<script"; nocase; content:"CollectGarbage"; distance:0; fast_pattern; content:"while"; pcre:"/^\s*?\([^\)]*?(?P<var>[^\.]+)\s*?\.\s*?length\s*<\s*(?:0?[0-9]{5,}|0x[a-z0-9]{3,})[^)]+\)\s*?\{\s*?(?P=var)\s*?=\s*?(?P=var)\s*?\+\s*?(?P=var)\s*?\}/Rsi"; content:"getElementsByClassName"; distance:0; content:"CollectGarbage"; distance:0; classtype:bad-unknown; sid:2018146; rev:4; metadata:created_at 2014_02_15, former_category CURRENT_EVENTS, updated_at 2014_02_15;)

alert udp any 67 -> any 68 (msg:"ET INFO Web Proxy Auto Discovery Protocol WPAD DHCP 252 option Possible BadTunnel"; content:"|02|"; depth:1; content:"|fc|"; byte_jump:1,0,relative,post_offset -9; content:"/wpad.dat"; within:9; fast_pattern; classtype:protocol-command-decode; sid:2022915; rev:1; metadata:created_at 2016_06_24, updated_at 2016_06_24;)

#alert udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO QUIC UDP Internet Connections Protocol Client Hello (OUTBOUND)"; flow:to_server; content:"|80 01|CHLO"; content:"PAD"; content:"SNI"; content:"CCS"; content:"PDMD"; content:"VERS"; nocase;flowbits:set,ET.QUIC.FirstClientHello; reference:url,tools.ietf.org/html/draft-tsvwg-quic-protocol-00; classtype:protocol-command-decode; sid:2022996; rev:1; metadata:attack_target Client_Endpoint, created_at 2016_08_01, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2016_08_01;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 33434 (msg:"ET INFO Noction IRP Probe"; flow:stateless; flags:SP; content:"|4E 4F 43 54 49 4F 4E 20 49 52 50|"; reference:url,www.noction.com/faq; classtype:bad-unknown; sid:2023640; rev:1; metadata:created_at 2016_12_14, deployment Perimeter, performance_impact Low, signature_severity Minor, updated_at 2016_12_14;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO ATF file in HTTP Flowbit Set"; flow:from_server,established; file_data; content:"|41 54 46|"; within:3; flowbits:set,ET.atf.in.http; flowbits:noalert; classtype:not-suspicious; sid:2023714; rev:2; metadata:attack_target Client_Endpoint, created_at 2017_01_10, deployment Perimeter, updated_at 2017_01_10;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Adobe FDF in HTTP Flowbit Set"; flow:from_server,established; file_data; content:"%FDF-"; within:5; flowbits:set,ET.fdf.in.http; flowbits:noalert; classtype:not-suspicious; sid:2023715; rev:2; metadata:affected_product Adobe_Reader, attack_target Client_Endpoint, created_at 2017_01_10, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2017_01_10;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possible Hex Obfuscated JavaScript Heap Spray 0a0a0a0a"; flow:established,to_client; file_data; content:"|5C|x0a|5C|x0a|5C|x0a|5C|x0a"; nocase; reference:url,www.darkreading.com/security/vulnerabilities/221901428/index.html; classtype:shellcode-detect; sid:2013267; rev:5; metadata:created_at 2011_07_14, updated_at 2017_01_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO MP4 in HTTP Flowbit Set"; flow:from_server,established; file_data; content:"|66 74 79 70 6D|"; offset:4; depth:5; content:"mp4"; within:12; flowbits:set,ET.mp4.in.http; flowbits:noalert; classtype:not-suspicious; sid:2023713; rev:3; metadata:attack_target Client_Endpoint, created_at 2017_01_10, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2017_02_10;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO MP4 in HTTP Flowbit Set M2"; flow:from_server,established; file_data; content:"|66 74 79 70 69 73 6f 6d|"; offset:4; depth:8; flowbits:set,ET.mp4.in.http; flowbits:noalert; classtype:not-suspicious; sid:2023892; rev:2; metadata:attack_target Client_Endpoint, created_at 2017_02_10, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2017_02_10;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO MP4 in HTTP Flowbit Set M3"; flow:from_server,established; file_data; content:"|66 74 79 70 71 74 20 20|"; offset:4; depth:8; flowbits:set,ET.mp4.in.http; flowbits:noalert; classtype:not-suspicious; sid:2023900; rev:2; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2017_02_14, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2017_02_14;)

#alert tcp any any -> any [139,445] (msg:"ET INFO Potentially unsafe SMBv1 protocol in use"; flow:established,to_server; content:"|FF|SMB"; offset:4; depth:4; content:!"r"; within:1; threshold: type limit, count 1, track by_src, seconds 1200; reference:url,www.us-cert.gov/ncas/current-activity/2017/01/16/SMB-Security-Best-Practices; reference:url,blogs.technet.microsoft.com/filecab/2016/09/16/stop-using-smb1/; classtype:not-suspicious; sid:2023997; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2017_02_17, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, updated_at 2017_03_03;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Mozilla User-Agent (Mozilla/5.0) Inbound Likely Fake"; flow:to_server,established; content:"User-Agent|3a| Mozilla/5.0|0d 0a|"; nocase; http_header; content:!"autodesk.com"; http_header; reference:url,doc.emergingthreats.net/2010908; classtype:trojan-activity; sid:2010908; rev:7; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_04_03;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET INFO http string in hex Possible Obfuscated Exploit Redirect"; flow:established,to_client; content:"=[|22 5c|x68|5c|x74|5c|x74|5c|x70|5c|x3A|5c|x2F|5c|x2F|5c|"; classtype:bad-unknown; sid:2012118; rev:3; metadata:created_at 2010_12_30, former_category CURRENT_EVENTS, updated_at 2017_04_14;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Adilbo HTML Encoder Observed"; flow:established,to_client; file_data; content:"|2f 2a 20 61 64 69 6c 62 6f 20 48 54 4d 4c 20 45 6e 63 6f 64 65 72|"; fast_pattern:2,20; content:"*|20 20|Checksum|3a 20|927c770095e0daa48298343b8fd14624"; within:200; classtype:policy-violation; sid:2024763; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2017_09_23, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2017_09_23;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Suspicious Darkwave Popads Pop Under Redirect"; flow:established,to_client; file_data; content:"|2f 2a 20 50 72 69 76 65 74 20 64 61 72 6b 76 2e 20 45 61 63 68 20 64 6f 6d 61 69 6e 20 69 73 20 32 68 20 66 6f 78 20 64 65 61 64 20 2a 2f|"; classtype:policy-violation; sid:2024764; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2017_09_23, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2017_09_23;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Download of Embedded OpenType (EOT) File flowbit set"; flow:established,to_client; file_data; content:"|4c 50|"; offset:34; depth:2; flowbits:set,ET.EOT.Download; flowbits:noalert; reference:url,www.w3.org/Submission/EOT/#FileFormat; classtype:misc-activity; sid:2024829; rev:2; metadata:affected_product Internet_Explorer, affected_product Mac_OSX, affected_product Microsoft_Edge_Browser, attack_target Client_Endpoint, created_at 2017_10_10, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Minor, updated_at 2017_10_10;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 5050 Inbound Request (Linux Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 13 ba|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003281; classtype:protocol-command-decode; sid:2003281; rev:6; metadata:created_at 2010_07_30, former_category INFO, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 443 Inbound Request (Windows Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 01 bb|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003268; classtype:protocol-command-decode; sid:2003268; rev:6; metadata:created_at 2010_07_30, former_category INFO, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 443 Inbound Request (Linux Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 01 bb|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003269; classtype:protocol-command-decode; sid:2003269; rev:6; metadata:created_at 2010_07_30, former_category INFO, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 25 Inbound Request (Windows Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 00 19|"; depth:4; threshold:type both, track by_src, count 2, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003256; classtype:protocol-command-decode; sid:2003256; rev:6; metadata:created_at 2010_07_30, former_category INFO, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 25 Inbound Request (Windows Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|00 19|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003254; classtype:protocol-command-decode; sid:2003254; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 25 Inbound Request (Linux Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|00 19|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003255; classtype:protocol-command-decode; sid:2003255; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 25 Inbound Request (Linux Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 00 19|"; depth:4; threshold:type both, track by_src, count 2, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003257; classtype:protocol-command-decode; sid:2003257; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 DNS Inbound Request (Windows Source)"; dsize:10<>40; flow:established,to_server; content:"|05 01 00 03|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003258; classtype:protocol-command-decode; sid:2003258; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 DNS Inbound Request (Linux Source)"; dsize:10<>40; flow:established,to_server; content:"|05 01 00 03|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003259; classtype:protocol-command-decode; sid:2003259; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 HTTP Proxy Inbound Request (Windows Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|00 50|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003260; classtype:protocol-command-decode; sid:2003260; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 HTTP Proxy Inbound Request (Linux Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|00 50|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003261; classtype:protocol-command-decode; sid:2003261; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 HTTP Proxy Inbound Request (Windows Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 00 50|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003262; classtype:protocol-command-decode; sid:2003262; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 HTTP Proxy Inbound Request (Linux Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 00 50|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003263; classtype:protocol-command-decode; sid:2003263; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 443 Inbound Request (Windows Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|01 bb|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003266; classtype:protocol-command-decode; sid:2003266; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 443 Inbound Request (Linux Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|01 bb|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003267; classtype:protocol-command-decode; sid:2003267; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 5190 Inbound Request (Windows Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|14 46|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003270; classtype:protocol-command-decode; sid:2003270; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 5190 Inbound Request (Linux Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|14 46|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003271; classtype:protocol-command-decode; sid:2003271; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 5190 Inbound Request (Windows Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 14 46|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003272; classtype:protocol-command-decode; sid:2003272; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 5190 Inbound Request (Linux Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 14 46|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003273; classtype:protocol-command-decode; sid:2003273; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 1863 Inbound Request (Windows Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|07 47|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003274; classtype:protocol-command-decode; sid:2003274; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 1863 Inbound Request (Linux Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|07 47|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003275; classtype:protocol-command-decode; sid:2003275; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 1863 Inbound Request (Windows Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 07 47|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003276; classtype:protocol-command-decode; sid:2003276; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 1863 Inbound Request (Linux Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 07 47|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003277; classtype:protocol-command-decode; sid:2003277; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 5050 Inbound Request (Windows Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|13 ba|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003278; classtype:protocol-command-decode; sid:2003278; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 32768:61000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv5 Port 5050 Inbound Request (Linux Source)"; dsize:10; flow:established,to_server; content:"|05 01 00 01|"; depth:4; content:"|13 ba|"; offset:8; depth:2; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003279; classtype:protocol-command-decode; sid:2003279; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert tcp $EXTERNAL_NET 1024:5000 -> $HOME_NET 1024:65535 (msg:"ET INFO SOCKSv4 Port 5050 Inbound Request (Windows Source)"; dsize:9<>18; flow:established,to_server; content:"|04 01 13 ba|"; depth:4; threshold:type both, track by_src, count 1, seconds 900; reference:url,handlers.sans.org/wsalusky/rants/; reference:url,en.wikipedia.org/wiki/SOCKS; reference:url,ss5.sourceforge.net/socks4.protocol.txt; reference:url,ss5.sourceforge.net/socks4A.protocol.txt; reference:url,www.ietf.org/rfc/rfc1928.txt; reference:url,www.ietf.org/rfc/rfc1929.txt; reference:url,www.ietf.org/rfc/rfc1961.txt; reference:url,www.ietf.org/rfc/rfc3089.txt; reference:url,doc.emergingthreats.net/bin/view/Main/2003280; classtype:protocol-command-decode; sid:2003280; rev:6; metadata:created_at 2010_07_30, former_category MALWARE, updated_at 2017_10_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAVA - Java Archive Download By Vulnerable Client"; flow:from_server,established; flowbits:isset,ET.http.javaclient.vulnerable; file_data; content:"PK"; depth:2; classtype:trojan-activity; sid:2014473; rev:5; metadata:created_at 2012_04_04, updated_at 2012_04_04;)

alert tcp any any -> any 4786 (msg:"ET INFO Cisco Smart Install Protocol Observed"; flow:established,only_stream; content:"|00 00 00 01 00 00 00 01|"; depth:8; reference:url,www.us-cert.gov/ncas/alerts/TA18-106A; classtype:misc-activity; sid:2025519; rev:1; metadata:attack_target Networking_Equipment, created_at 2018_04_20, deployment Perimeter, deployment Internal, former_category INFO, signature_severity Minor, updated_at 2018_04_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Adobe PDF in HTTP Flowbit Set"; flow:from_server,established; file_data; content:"%PDF-"; within:6; flowbits:set,ET.pdf.in.http; flowbits:noalert; reference:cve,CVE-2008-2992; reference:bugtraq,30035; reference:secunia,29773; classtype:not-suspicious; sid:2015671; rev:10; metadata:created_at 2010_09_25, updated_at 2010_09_25;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Adobe PDX in HTTP Flowbit Set"; flow:from_server,established; file_data; content:"%PDX-"; within:5; flowbits:set,ET.pdx.in.http; flowbits:noalert; classtype:not-suspicious; sid:2025985; rev:2; metadata:affected_product Adobe_Reader, created_at 2018_08_10, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2018_08_10;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Adobe Flash Uncompressed in HTTP Flowbit Set"; flow:from_server,established; file_data; content:"FWS"; within:3; flowbits:set,HTTP.UncompressedFlash; flowbits:noalert; classtype:not-suspicious; sid:2016394; rev:7; metadata:created_at 2013_02_09, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2018_08_10;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAR Containing Executable Downloaded"; flow:established,to_client; flowbits:isset,ET.http.javaclient; file_data; content:"PK"; within:2; content:".exe"; fast_pattern; nocase; classtype:trojan-activity; sid:2016379; rev:6; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2013_02_08, deployment Perimeter, former_category CURRENT_EVENTS, signature_severity Major, tag DriveBy, updated_at 2018_10_09;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Certificate with Unknown Content M2"; flow:established,to_client; file_data; content:"-----BEGIN CERTIFICATE-----|0A|"; depth:28; fast_pattern; byte_test:1,!=,0x4D,0,relative; reference:url,blog.nviso.be/2018/07/31/powershell-inside-a-certificate-part-1/; classtype:misc-activity; sid:2026684; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2018_12_04, deployment Perimeter, former_category INFO, performance_impact Moderate, signature_severity Informational, updated_at 2018_12_04;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Certificate with Unknown Content M1"; flow:established,to_client; file_data; content:"-----BEGIN CERTIFICATE-----|0D 0A|"; depth:29; fast_pattern; byte_test:1,!=,0x4D,0,relative; reference:url,blog.nviso.be/2018/07/31/powershell-inside-a-certificate-part-1/; classtype:misc-activity; sid:2026649; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2018_11_26, deployment Perimeter, former_category INFO, performance_impact Moderate, signature_severity Major, updated_at 2018_11_26;)

#alert tls $HOME_NET any -> $EXTERNAL_NET 853 (msg:"ET INFO DNS Over TLS Request Outbound"; flow:established,to_server; content:"|16 03 01 01|"; depth:4; reference:url,www.linuxbabe.com/ubuntu/ubuntu-stubby-dns-over-tls; classtype:trojan-activity; sid:2026774; rev:2; metadata:created_at 2019_01_10, former_category INFO, updated_at 2019_01_10;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possible RTF File With Obfuscated Version Header"; flow:established,to_client; file_data; content:"{|5C|rt"; within:4; content:!"f"; within:1; classtype:bad-unknown; sid:2026863; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2019_01_30, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2019_01_30;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell NoProfile Command Received In Powershell Stagers"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"-nop"; nocase; distance:0; classtype:trojan-activity; sid:2026988; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Minor, tag PowerShell, updated_at 2019_02_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell Hidden Window Command Common In Powershell Stagers M1"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"-w"; nocase; distance:0; content:"hidden"; within:17; classtype:trojan-activity; sid:2026989; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, updated_at 2019_02_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell Hidden Window Command Common In Powershell Stagers M2"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"-w 1"; nocase; distance:0; classtype:trojan-activity; sid:2026990; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, updated_at 2019_02_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell NonInteractive Command Common In Powershell Stagers"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"-noni"; nocase; distance:0; classtype:trojan-activity; sid:2026991; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, updated_at 2019_02_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell Base64 Encoded Content Command Common In Powershell Stagers M2"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"FromBase64String|28|"; nocase; distance:0; classtype:trojan-activity; sid:2026993; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, updated_at 2019_02_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell DownloadFile Command Common In Powershell Stagers"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"DownloadFile|28|"; nocase; distance:0; classtype:trojan-activity; sid:2026994; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, updated_at 2019_02_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell DownloadString Command Common In Powershell Stagers"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"DownloadString|28|"; nocase; distance:0; classtype:trojan-activity; sid:2026995; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, updated_at 2019_02_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell DownloadData Command Common In Powershell Stagers"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"DownloadData|28|"; nocase; distance:0; classtype:trojan-activity; sid:2026996; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, updated_at 2019_02_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell Base64 Encoded Content Command Common In Powershell Stagers M1"; flow:established,from_server; file_data; content:"powershell"; fast_pattern; nocase; content:"|20|-e"; nocase; distance:0; pcre:"/^(?:nc)?\s*(?:[A-Z0-9+\/]{4})*(?:[A-Z0-9+\/]{2}==|[A-Z0-9+\/]{3}=)/Ri"; classtype:trojan-activity; sid:2026992; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_02_28, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, updated_at 2019_03_05;)

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Anyplace Remote Access Initial Connection Attempt (005)"; flow:established,to_server; content:"HTTP|2f|1.1|20|005|0d 0a|VERSION|3a 20|"; depth:23; content:"PLATFORM|3a 20|"; distance:0; content:"IPADDRESS|3a 20|"; distance:0; fast_pattern; reference:md5,30e4f96590d530ba5dc1762f8b87c16b; classtype:trojan-activity; sid:2027323; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_05_07, deployment Perimeter, deployment Internal, former_category INFO, malware_family Anyplace, performance_impact Low, signature_severity Major, tag RAT, updated_at 2019_05_07;)

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Anyplace Remote Access Checkin (051)"; flow:established,to_server; content:"HTTP|2f|1.1|20|051"; depth:12; content:"VER|3a 20|"; distance:0; content:"OBJ|3a 20|"; distance:0; content:"FUNC|3a 20|"; distance:0; content:"NAME|3a 20|"; distance:0; content:"ACC|3a 20|"; distance:0; content:"SRV|3a 20|"; distance:0; content:"PRODUCT|3a 20|"; distance:0; fast_pattern; reference:md5,30e4f96590d530ba5dc1762f8b87c16b; classtype:trojan-activity; sid:2027324; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, created_at 2019_05_07, deployment Perimeter, deployment Internal, former_category INFO, malware_family Anyplace, performance_impact Low, signature_severity Major, tag RAT, updated_at 2019_05_07;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.biz Domain"; flow:established,to_server; content:".biz"; fast_pattern; http_host; isdataat:!1,relative; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027872; rev:2; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2019_08_13;)

alert udp $HOME_NET any -> any 53 (msg:"ET INFO DNS Query for a Suspicious Malware Related Numerical .in Domain"; content:"|01|"; offset:2; depth:1; content:"|00 01 00 00 00 00 00|"; distance:1; within:7; content:"|02|in|00|"; fast_pattern; nocase; distance:0; pcre:"/\x00[0-9]{4,7}\x02in\x00/i"; reference:url,sign.kaffenews.com/?p=104; reference:url,www.isc.sans.org/diary.html?storyid=10165; classtype:bad-unknown; sid:2012115; rev:7; metadata:created_at 2010_12_30, former_category HUNTING, updated_at 2019_08_29;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Embedded Executable File in PDF - This Program Cannot Be Run in DOS Mode"; flow:established,to_client; flowbits:isset,ET.pdf.in.http; file_data; content:"This program cannot be run in DOS mode"; nocase; classtype:bad-unknown; sid:2011865; rev:7; metadata:attack_target Client_Endpoint, created_at 2010_10_29, deployment Perimeter, signature_severity Major, updated_at 2019_09_27;)

alert http any any -> any any (msg:"ET INFO Possible Sandvine PacketLogic Injection"; flow:established,from_server; id:13330; flags:AF; content:"HTTP/1.1 307 Temporary Redirect|0a|Location|3a 20|"; depth:42; fast_pattern; content:"Connection: close|0a 0a|"; distance:0; endswith; reference:url,citizenlab.ca/2018/03/bad-traffic-sandvines-packetlogic-devices-deploy-government-spyware-turkey-syria/; classtype:misc-activity; sid:2025428; rev:2; metadata:attack_target Client_and_Server, created_at 2018_03_13, deployment Datacenter, former_category INFO, performance_impact Low, signature_severity Minor, updated_at 2019_09_28;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO WinUpack Modified PE Header Inbound"; flow:established; content:"|4d 5a 4b 45 52 4e 45 4c 33 32 2e 44 4c 4c 00 00|"; fast_pattern; reference:url,doc.emergingthreats.net/bin/view/Main/WinPEHeaders; classtype:bad-unknown; sid:2003614; rev:6; metadata:created_at 2010_07_30, updated_at 2019_10_08;)

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO WinUpack Modified PE Header Outbound"; flow:established; content:"|4d 5a 4b 45 52 4e 45 4c 33 32 2e 44 4c 4c 00 00|"; fast_pattern; reference:url,doc.emergingthreats.net/bin/view/Main/WinPEHeaders; classtype:bad-unknown; sid:2003615; rev:7; metadata:created_at 2010_07_30, updated_at 2019_10_08;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE SCardForgetReaderGroupA (Used in Malware Anti-Debugging)"; flow:established,to_client; file_data; flowbits:isset,ET.http.binary; content:"SCardForgetReaderGroupA"; fast_pattern; reference:url,www.trusteer.com/blog/evading-malware-researchers-shylock%E2%80%99s-new-trick; classtype:misc-activity; sid:2015965; rev:5; metadata:created_at 2012_11_30, updated_at 2019_10_08;)

alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"ET INFO Possible TURKTRUST Spoofed Google Cert"; flow:established,from_server; content:"|16 03|"; depth:2; content:"*.EGO.GOV.TR"; nocase; fast_pattern; content:"*.google.com"; classtype:policy-violation; sid:2016154; rev:2; metadata:created_at 2013_01_04, former_category CURRENT_EVENTS, updated_at 2019_10_08;)

alert udp $HOME_NET 1900 -> any any (msg:"ET INFO UPnP Discovery Search Response vulnerable UPnP device 1"; content:"miniupnpd/1."; fast_pattern; pcre:"/^Server\x3a[^\r\n]*miniupnpd\/1\.[0-3]/mi"; reference:url,community.rapid7.com/community/infosec/blog/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play; reference:url,upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf; reference:cve,2013-0229; classtype:successful-recon-limited; sid:2016302; rev:6; metadata:created_at 2013_01_30, updated_at 2019_10_08;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Serialized Java Applet (Used by some EKs in the Wild)"; flow:established,from_server; file_data; content:"<embed"; nocase; content:"object"; distance:0; nocase; pcre:"/^[\r\n\s]*=[\r\n\s]*[\x22\x27][^\x22\x27]+\.ser[\x22\x27]/Ri"; content:"application/x-java-"; fast_pattern; classtype:exploit-kit; sid:2016510; rev:5; metadata:created_at 2013_02_27, former_category INFO, updated_at 2019_10_08;)

alert tls $HOME_NET any -> 195.22.26.192/26 443 (msg:"ET INFO invalid.cab domain in SNI"; flow:established,to_server; content:"|0b|invalid.cab"; fast_pattern; flowbits:set,ET.invalid.cab; flowbits:noalert; classtype:misc-activity; sid:2020888; rev:3; metadata:created_at 2015_04_10, updated_at 2019_10_08;)

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO form-data flowbit set (noalert)"; flow:to_server,established; dsize:>0; content:"Content-Type|3a 20|multipart|2f|form-data"; fast_pattern; flowbits:set,ET.formdata; flowbits:noalert; classtype:not-suspicious; sid:2022080; rev:2; metadata:created_at 2015_11_12, updated_at 2019_10_08;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAVA - Java Archive Download"; flow:from_server,established; flowbits:isnotset,ET.http.javaclient.vulnerable; flowbits:isset,ET.http.javaclient; file_data; content:"PK"; within:2; content:".class"; nocase; fast_pattern; classtype:trojan-activity; sid:2014472; rev:8; metadata:created_at 2012_04_04, updated_at 2019_10_08;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Generic HeapSpray Construct"; flow:established,to_client; file_data; content:"CollectGarbage"; nocase; fast_pattern; content:"var"; pcre:"/^\s+?(?P<vname>[^\s\x3d]+)\s*?=\s*?(?:0x(?:(6[4-9a-f]|[7-9a-f])|\d{3,})|\d{3,}).+?[\s\x3b]for\s*?\([^\x3b\)]*?\x3b[^\x3b\)]+?<=?\s*?(?P=vname)[^\)]+?\)\s*?(?:\{[^}]*?|[^\r\n]*?)document\s*\.\s*createElement/Rsi"; classtype:bad-unknown; sid:2018145; rev:5; metadata:created_at 2014_02_15, former_category CURRENT_EVENTS, updated_at 2019_10_08;)

alert udp any any -> $HOME_NET 137 (msg:"ET INFO NBNS Name Query Response Possible WPAD Spoof BadTunnel"; byte_test:1,&,0x80,2; byte_test:1,!&,0x40,2; byte_test:1,!&,0x20,2; byte_test:1,!&,0x10,2; byte_test:1,=,0x00,3; content:"|00 00|"; offset:4; depth:2; content:"|46 48 46 41 45 42 45|"; fast_pattern; reference:url,tools.ietf.org/html/draft-ietf-wrec-wpad-01; reference:url,ietf.org/rfc/rfc1002.txt; classtype:protocol-command-decode; sid:2022914; rev:2; metadata:created_at 2016_06_23, updated_at 2019_10_08;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Applet Tag In Edwards Packed JavaScript"; flow:established,to_client; file_data; content:"eval(function(p,a,c"; content:"|7C|applet|7C|"; nocase; fast_pattern; content:!"|7C|_dynarch_popupCalendar|7C|"; classtype:bad-unknown; sid:2015708; rev:6; metadata:created_at 2012_09_18, former_category INFO, updated_at 2019_10_08;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Lock Emoji In Title - Possible Social Engineering Attempt"; flow:from_server,established; file_data; content:"<title>"; nocase; pcre:"/^(?:(?!<\/title).)*\x26\x23x1F512/Ri"; content:"|26 23|x1F512"; fast_pattern; classtype:trojan-activity; sid:2023749; rev:3; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2017_01_19, deployment Perimeter, performance_impact Low, signature_severity Major, tag Phishing, updated_at 2019_10_08;)

alert smtp $EXTERNAL_NET any -> $SMTP_SERVERS any (msg:"ET INFO SMTP PDF Attachment Flowbit Set"; flow:established,from_server; content:"|0d 0a 0d 0a|JVBERi"; fast_pattern; flowbits:set,ET.pdf.in.smtp.attachment; flowbits:noalert; classtype:bad-unknown; sid:2024236; rev:3; metadata:attack_target SMTP_Server, created_at 2017_04_21, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2019_10_08;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO TLS Handshake Failure"; flow:established,to_client; dsize:7; content:"|15|"; depth:1; content:"|00 02 02 28|"; distance:2; within:4; fast_pattern; classtype:bad-unknown; sid:2029340; rev:2; metadata:attack_target Client_Endpoint, created_at 2020_01_30, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2020_01_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Bit.do Shortened Link Request (set)"; flow:established,to_server; flowbits:set,ET.bit.do.shortener; http.method; content:"GET"; http.header; content:"Host|3a 20|bit.do|0d 0a|Connection|3a 20|Keep-Alive|0d 0a|"; depth:38; fast_pattern; http.header_names; content:"|0d 0a|Host|0d 0a|Connection|0d 0a 0d 0a|"; depth:22; isdataat:!1,relative; classtype:misc-activity; sid:2029549; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2020_02_28, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2020_02_28;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host DLL Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.dll; flowbits:unset,http.dottedquadhost; http.request_line; content:".dll HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027250; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Moderate, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host DOC Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.doc; flowbits:unset,http.dottedquadhost; http.request_line; content:".doc HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027251; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host DOCX Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.docx; flowbits:unset,http.dottedquadhost; http.request_line; content:".docx HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027252; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host XLS Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.xls; flowbits:unset,http.dottedquadhost; http.request_line; content:".xls HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027253; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host XLSX Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.xlsx; flowbits:unset,http.dottedquadhost; http.request_line; content:".xlsx HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027254; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, tag Phishing, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host PPT Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.ppt; flowbits:unset,http.dottedquadhost; http.request_line; content:".ppt HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027255; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host PPTX Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.pptx; flowbits:unset,http.dottedquadhost; http.request_line; content:".pptx HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027256; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, tag Phishing, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host RTF Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.rtf; flowbits:unset,http.dottedquadhost; http.request_line; content:".rtf HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027257; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host PS Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.ps; flowbits:unset,http.dottedquadhost; http.request_line; content:".ps HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027258; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, tag Phishing, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host VBS Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.vbs; flowbits:unset,http.dottedquadhost; http.request_line; content:".vbs HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027260; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host HTA Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.hta; flowbits:unset,http.dottedquadhost; http.request_line; content:".hta HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027261; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Moderate, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host ZIP Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.zip; flowbits:unset,http.dottedquadhost; http.request_line; content:".zip HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027262; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host GZ Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.gz; flowbits:unset,http.dottedquadhost; http.request_line; content:".gz HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027263; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host TGZ Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.tgz; flowbits:unset,http.dottedquadhost; http.request_line; content:".tgz HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027264; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host PDF Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.pdf; flowbits:unset,http.dottedquadhost; http.request_line; content:".pdf HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027265; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host RAR Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.rar; flowbits:unset,http.dottedquadhost; http.request_line; content:".rar HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027266; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2020_04_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.myftp.biz Domain"; flow:established,to_server; http.host; content:".myftp.biz|0d 0a|"; endswith; classtype:bad-unknown; sid:2013824; rev:5; metadata:created_at 2011_11_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.ez-dns.com Domain"; flow:established,to_server; http.host; content:".ez-dns.com"; endswith; classtype:bad-unknown; sid:2013846; rev:4; metadata:created_at 2011_11_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.dyndns-web.com Domain"; flow:to_server,established; http.host; content:".dyndns-web.com"; endswith; classtype:bad-unknown; sid:2013864; rev:4; metadata:created_at 2011_11_07, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.3d-game.com Domain"; flow:established,to_server; http.host; content:".3d-game.com"; endswith; classtype:bad-unknown; sid:2014479; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.4irc.com Domain"; flow:established,to_server; http.host; content:".4irc.com"; endswith; classtype:bad-unknown; sid:2014481; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.b0ne.com Domain"; flow:established,to_server; http.host; content:".b0ne.com"; endswith; classtype:bad-unknown; sid:2014483; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.bbsindex.com Domain"; flow:established,to_server; http.host; content:".bbsindex.com"; endswith; classtype:bad-unknown; sid:2014485; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.chatnook.com Domain"; flow:established,to_server; http.host; content:".chatnook.com"; endswith; classtype:bad-unknown; sid:2014487; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.darktech.org Domain"; flow:established,to_server; http.host; content:".darktech.org"; endswith; classtype:bad-unknown; sid:2014489; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.deaftone.com Domain"; flow:established,to_server; http.host; content:".deaftone.com"; endswith; classtype:bad-unknown; sid:2014491; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.effers.com Domain"; flow:established,to_server; http.host; content:".effers.com"; endswith; classtype:bad-unknown; sid:2014495; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.etowns.net Domain"; flow:established,to_server; http.host; content:".etowns.net"; endswith; classtype:bad-unknown; sid:2014497; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.etowns.org Domain"; flow:established,to_server; http.host; content:".etowns.org"; endswith; classtype:bad-unknown; sid:2014499; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.flnet.org Domain"; flow:established,to_server; http.host; content:".flnet.org"; endswith; classtype:bad-unknown; sid:2014501; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.gotgeeks.com Domain"; flow:established,to_server; http.host; content:".gotgeeks.com"; endswith; classtype:bad-unknown; sid:2014503; rev:4; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.scieron.com Domain"; flow:established,to_server; http.host; content:".scieron.com"; endswith; classtype:bad-unknown; sid:2014505; rev:5; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.slyip.com Domain"; flow:established,to_server; http.host; content:".slyip.com"; endswith; classtype:bad-unknown; sid:2014507; rev:5; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.slyip.net Domain"; flow:established,to_server; http.host; content:".slyip.net"; endswith; classtype:bad-unknown; sid:2014509; rev:5; metadata:created_at 2012_04_05, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a 3322.net Domain *.2288.org"; flow:established,to_server; http.host; content:".2288.org"; endswith; classtype:misc-activity; sid:2014787; rev:6; metadata:created_at 2012_05_19, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a 3322.net Domain *.6600.org"; flow:established,to_server; http.host; content:".6600.org"; endswith; classtype:misc-activity; sid:2014789; rev:5; metadata:created_at 2012_05_19, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a 3322.net Domain *.7766.org"; flow:established,to_server; http.host; content:".7766.org"; endswith; classtype:misc-activity; sid:2014790; rev:7; metadata:created_at 2012_05_19, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a 3322.net Domain *.8800.org"; flow:established,to_server; http.host; content:".8800.org"; endswith; classtype:misc-activity; sid:2014791; rev:6; metadata:created_at 2012_05_19, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a 3322.net Domain *.9966.org"; flow:established,to_server; http.host; content:".9966.org"; endswith; classtype:misc-activity; sid:2014792; rev:6; metadata:created_at 2012_05_19, updated_at 2020_04_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a dns-stuff.com Domain *.dns-stuff.com"; flow:established,to_server; http.host; content:"dns-stuff.com"; endswith; classtype:bad-unknown; sid:2014867; rev:4; metadata:created_at 2012_06_07, updated_at 2020_04_21;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE - Served Attached HTTP"; flow:to_client,established; http.header; content:"Content-Disposition"; nocase; content:"attachment"; nocase; file.data; content:"MZ"; within:2; classtype:misc-activity; sid:2014520; rev:7; metadata:created_at 2012_04_06, updated_at 2020_04_22;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS UA starting with Mozilla/0"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Mozilla/0"; fast_pattern; nocase; classtype:bad-unknown; sid:2016695; rev:3; metadata:created_at 2013_04_02, updated_at 2020_04_23;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET INFO Generic HTTP EXE Upload Inbound"; flow:established,to_server; http.method; content:"POST"; nocase; http.request_body; content:"MZ"; content:"|00 00 00 00|"; distance:0; content:"PE|00 00|"; fast_pattern; distance:0; classtype:misc-activity; sid:2016774; rev:3; metadata:created_at 2013_04_19, updated_at 2020_04_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Generic HTTP EXE Upload Outbound"; flow:established,to_server; http.method; content:"POST"; nocase; http.request_body; content:"MZ"; content:"|00 00 00 00|"; distance:0; content:"PE|00 00|"; fast_pattern; distance:0; classtype:misc-activity; sid:2016775; rev:3; metadata:created_at 2013_04_19, updated_at 2020_04_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS UA starting with Mozilla/7"; flow:established,to_server; http.user_agent; content:"Mozilla/7"; depth:9; nocase; classtype:bad-unknown; sid:2016692; rev:5; metadata:created_at 2013_04_02, updated_at 2020_04_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS UA starting with Mozilla/9"; flow:established,to_server; http.user_agent; content:"Mozilla/9"; depth:9; nocase; classtype:bad-unknown; sid:2016694; rev:5; metadata:created_at 2013_04_02, updated_at 2020_04_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Windows NT version 0 User-Agent"; flow:established,to_server; http.user_agent; content:"Windows NT 0"; nocase; classtype:trojan-activity; sid:2016880; rev:7; metadata:created_at 2013_05_21, updated_at 2020_04_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious MSIE 10 on Windows NT 5"; flow:established,to_server; threshold: type limit,track by_src,count 2,seconds 60; http.user_agent; content:" MSIE 10.0|3b| Windows NT 5."; fast_pattern; classtype:trojan-activity; sid:2016898; rev:7; metadata:created_at 2013_05_21, updated_at 2020_04_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Executable Served From /tmp/ Directory - Malware Hosting Behaviour"; flow:established,to_server; http.uri; content:"/tmp/"; depth:5; content:".exe"; distance:0; pcre:"/^\/tmp\/.+\.exe$/"; classtype:bad-unknown; sid:2016985; rev:3; metadata:created_at 2013_06_07, updated_at 2020_04_24;)

alert http any any -> any any (msg:"ET INFO HTTP POST contains pasa= in cleartext"; flow:established,to_server; http.request_body; content:"pasa="; pcre:"/^(?!&)./R"; classtype:policy-violation; sid:2017080; rev:3; metadata:created_at 2013_07_02, former_category INFO, updated_at 2020_04_24;)

alert http any any -> any any (msg:"ET INFO HTTP URI contains pasa="; flow:established,to_server; http.uri; content:"pasa="; nocase; pcre:"/(?<=(?:\?|&))pasa=(?!&)./i"; classtype:policy-violation; sid:2017081; rev:3; metadata:created_at 2013_07_02, former_category INFO, updated_at 2020_04_24;)

alert http any any -> any any (msg:"ET INFO HTTP POST contains pasa form"; flow:established,to_server; http.request_body; content:"name=|22|pasa|22|"; classtype:policy-violation; sid:2017082; rev:3; metadata:created_at 2013_07_02, former_category INFO, updated_at 2020_04_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Serialized Data request"; flow:established,to_server; http.uri; content:".ser"; endswith; http.user_agent; content:"Java/1."; classtype:bad-unknown; sid:2016504; rev:5; metadata:created_at 2013_02_26, updated_at 2020_04_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Adobe PKG Download Flowbit Set"; flow:established,to_server; flowbits:set,ET.Adobe.Site.Download; flowbits:noalert; http.uri; content:"pkg"; http.host; content:"platformdl.adobe.com"; bsize:20; classtype:misc-activity; sid:2017294; rev:4; metadata:created_at 2013_08_07, updated_at 2020_04_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO InetSim Response from External Source Possible SinkHole"; flow:from_server,established; http.server; content:"INetSim HTTP Server"; bsize:19; classtype:bad-unknown; sid:2017363; rev:3; metadata:created_at 2013_08_21, updated_at 2020_04_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO DRIVEBY Generic - *.com.exe HTTP Attachment"; flow:established,to_client; http.header; content:".com.exe"; nocase; file.data; content:"MZ"; within:2; classtype:trojan-activity; sid:2017504; rev:5; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2013_09_21, deployment Perimeter, former_category CURRENT_EVENTS, signature_severity Major, tag DriveBy, updated_at 2020_04_27;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.ddns.info Domain"; flow:established,to_server; http.host; content:".ddns.info"; endswith; classtype:bad-unknown; sid:2018220; rev:6; metadata:created_at 2011_12_15, updated_at 2020_04_28;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.ddns.name Domain"; flow:established,to_server; http.host; content:".ddns.name"; endswith; classtype:bad-unknown; sid:2018221; rev:6; metadata:created_at 2011_12_15, updated_at 2020_04_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAR Sent Claiming To Be Image - Likely Exploit Kit"; flow:established,to_client; flowbits:isset,ET.http.javaclient; http.content_type; content:"image/"; startswith; file.data; content:"PK"; within:2; content:".class"; fast_pattern; distance:10; within:500; classtype:exploit-kit; sid:2018233; rev:3; metadata:created_at 2014_03_08, former_category INFO, updated_at 2020_04_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAR Sent Claiming To Be Text Content - Likely Exploit Kit"; flow:established,to_client; flowbits:isset,ET.http.javaclient; http.content_type; content:"text/"; startswith; file.data; content:"PK"; within:2; content:".class"; fast_pattern; distance:10; within:500; classtype:exploit-kit; sid:2018234; rev:3; metadata:created_at 2014_03_08, former_category INFO, updated_at 2020_04_28;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS Java Request to NOIP Dynamic DNS Domain"; flow:to_server,established; http.host; pcre:"/\.(?:s(?:e(?:rve(?:(?:(?:(?:counterstri|qua)k|exchang|gam)e|h(?:alflife|umour|ttp)|p(?:ics|2p)|sarcasm|ftp)\.com|m(?:inecraft\.net|p3\.com)|b(?:eer\.com|log\.net))|curity(?:exploit|tactic)s\.com)|tufftoread\.com|ytes\.net)|m(?:y(?:(?:(?:dissen|effec)t|mediapc|psx)\.net|securitycamera\.(?:com|net|org)|(?:activedirectory|vnc)\.com|ftp\.(?:biz|org))|lbfan\.org|mafan\.biz)|d(?:(?:itchyourip|amnserver|ynns)\.com|dns(?:\.(?:net|me)|king\.com)|ns(?:iskinky\.com|for\.me)|vrcam\.info)|n(?:o(?:-ip\.(?:c(?:o\.uk|a)|info|biz|net|org)|ip\.(?:me|us))|et-freaks\.com|flfan\.org|hlfan\.net)|h(?:o(?:mesecurity(?:ma|p)c\.com|pto\.(?:org|me))|ealth-carereform\.com)|p(?:(?:rivatizehealthinsurance|gafan)\.net|oint(?:2this\.com|to\.us))|c(?:(?:o(?:uchpotatofries|llegefan)|able-modem)\.org|iscofreak\.com)|g(?:o(?:lffan\.us|tdns\.ch)|eekgalaxy\.com)|b(?:logsyte\.com|ounceme\.net|rasilia\.me)|re(?:ad-books\.org|directme\.net)|u(?:nusualperson\.com|fcfan\.org)|w(?:orkisboring\.com|ebhop\.me)|(?:3utiliti|quicksyt)es\.com|eating-organic\.net|ilovecollege\.info|fantasyleague\.cc|loginto\.me|zapto\.org)(?:\x3a\d{1,5})?$/"; http.user_agent; content:"Java/1."; classtype:bad-unknown; sid:2016582; rev:6; metadata:created_at 2013_03_15, former_category HUNTING, updated_at 2020_04_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS Java Request to ChangeIP Dynamic DNS Domain"; flow:to_server,established; http.host; pcre:"/\.(?:m(?:y(?:p(?:op3\.(?:net|org)|icture\.info)|n(?:etav\.(?:net|org)|umber\.org)|(?:secondarydns|lftv|03)\.com|d(?:ad\.info|dns\.com)|ftp\.(?:info|name)|(?:mom|z)\.info|www\.biz)|(?:r(?:b(?:asic|onus)|(?:slov|fac)e)|efound)\.com|oneyhome\.biz)|d(?:yn(?:amicdns\.(?:(?:org|co|me)\.uk|biz)|dns\.pro|ssl\.com)|ns(?:(?:-(?:stuff|dns)|0[45]|et|rd)\.com|[12]\.us)|dns\.(?:m(?:e\.uk|obi|s)|info|name|us)|(?:smtp|umb1)\.com|hcp\.biz)|(?:j(?:u(?:ngleheart|stdied)|etos|kub)|y(?:ou(?:dontcare|rtrap)|gto)|4(?:mydomain|dq|pu)|q(?:high|poe)|2(?:waky|5u)|z(?:yns|zux)|vizvaz|1dumb)\.com|s(?:e(?:(?:llclassics|rveusers?|ndsmtp)\.com|x(?:idude\.com|xxy\.biz))|quirly\.info|sl443\.org|ixth\.biz)|o(?:n(?:mypc\.(?:info|biz|net|org|us)|edumb\.com)|(?:(?:urhobb|cr)y|rganiccrap|tzo)\.com)|f(?:ree(?:(?:ddns|tcp)\.com|www\.(?:info|biz))|a(?:qserv|rtit)\.com|tp(?:server|1)\.biz)|a(?:(?:(?:lmostm|cmeto)y|mericanunfinished)\.com|uthorizeddns\.(?:net|org|us))|n(?:s(?:0(?:1\.(?:info|biz|us)|2\.(?:info|biz|us))|[123]\.name)|inth\.biz)|c(?:hangeip\.(?:n(?:ame|et)|org)|leansite\.(?:info|biz|us)|ompress\.to)|i(?:(?:t(?:emdb|saol)|nstanthq|sasecret|kwb)\.com|ownyour\.(?:biz|org))|g(?:r8(?:domain|name)\.biz|ettrials\.com|ot-game\.org)|l(?:flink(?:up\.(?:com|net|org)|\.com)|ongmusic\.com)|t(?:o(?:ythieves\.com|h\.info)|rickip\.(?:net|org))|(?:undefineddynamic-dns|rebatesrule|3-a)\.net|x(?:x(?:xy\.(?:info|biz)|uz\.com)|24hr\.com)|p(?:canywhere\.net|roxydns\.com|ort25\.biz)|w(?:ww(?:host|1)\.biz|ikaba\.com|ha\.la)|e(?:(?:smtp|dns)\.biz|zua\.com|pac\.to)|https443\.(?:net|org)|bigmoney\.biz)(?:\x3a\d{1,5})?$/"; http.user_agent; content:"Java/1."; classtype:bad-unknown; sid:2016581; rev:5; metadata:created_at 2013_03_15, former_category HUNTING, updated_at 2020_04_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS Java Request to Afraid.org Top 100 Dynamic DNS Domain"; flow:to_server,established; http.host; pcre:"/\.(?:s(?:tr(?:eetdirectory\.co\.id|angled\.net)|(?:at(?:dv\.net|-dv)|vlen)\.ru(?:pacetechnology\.ne|oon\.i)t|hop\.tm|uka\.se)|c(?:(?:hickenkiller|rabdance)\.com|o(?:ntinent\.kz|alnet\.ru)|sproject\.org|c\.st|f\.gs)|m(?:i(?:ne(?:craftn(?:ation\.net|oob\.com)|\.bz)|l\.nf)|ooo\.(?:info|com)|adhacker\.biz)|t(?:h(?:emafia\.info|cgirls\.com)|wilightparadox\.com|ime4film\.ru|ruecsi\.org|28\.net)|a(?:(?:(?:vangardkennel|gropeople)\.r|buser\.e)u|ntongorbunov\.com|llowed\.org|x\.lt)|h(?:a(?:ck(?:quest\.com|ed\.jp)|ppyforever\.com)|ome(?:net\.or|\.k)g|-o-s-t\.name)|p(?:(?:rivatedns|sybnc|ort0|wnz)\.org|(?:hoto-frame|irat3)\.com|unked\.us)|i(?:n(?:fo\.(?:gf|tm)|c\.gs)|gnorelist\.com|iiii\.info|z\.rs)|b(?:i(?:gbox\.info|z\.tm)|yte4byte\.com|ot\.nu|rb\.dj)|d(?:earabba\.org|-n-s\.name|alnet\.ca|ynet\.com)|(?:w(?:ith-linux|hynotad)|3dxtras|ohbah)\.com|u(?:n(?:do\.it|i\.cx)|k\.(?:is|to)|s\.to)|v(?:(?:erymad\.ne|r\.l)t|ietnam\.ro)|r(?:o(?:ot\.sx|\.lt)|-o-o-t\.net)|n(?:eon\.org|ow\.im|a\.tl|x\.tc)|j(?:umpingcrab\.com|avafaq\.nu)|f(?:(?:art|ram)ed\.net|tp\.sh)|(?:k(?:ir22\.r|\.v)|69\.m)u|l(?:inux[dx]\.org|eet\.la)|e(?:vils\.in|z\.lv)|(?:24-7\.r|qc\.t)o|(?:55|gw)\.lt|1337\.cx)(?:\x3a\d{1,5})?$/"; http.user_agent; content:"Java/1."; classtype:bad-unknown; sid:2016933; rev:6; metadata:created_at 2013_05_29, former_category INFO, updated_at 2020_04_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.co.com.au domain"; flow:to_server,established; http.host; content:".co.com.au"; endswith; classtype:bad-unknown; sid:2013412; rev:4; metadata:created_at 2011_08_16, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.cz.tf domain"; flow:to_server,established; http.host; content:".cz.tf"; endswith; classtype:bad-unknown; sid:2013415; rev:4; metadata:created_at 2011_08_17, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.c0m.li domain"; flow:to_server,established; http.host; content:".c0m.li"; endswith; classtype:bad-unknown; sid:2013460; rev:4; metadata:created_at 2011_08_26, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.int.tf domain"; flow:to_server,established; http.host; content:".int.tf"; endswith; classtype:bad-unknown; sid:2013829; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.edu.tf domain"; flow:to_server,established; http.host; content:".edu.tf"; endswith; classtype:bad-unknown; sid:2013830; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.us.tf domain"; flow:to_server,established; http.host; content:".us.tf"; endswith; classtype:bad-unknown; sid:2013831; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.ca.tf domain"; flow:to_server,established; http.host; content:".ca.tf"; endswith; classtype:bad-unknown; sid:2013832; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.bg.tf domain"; flow:to_server,established; http.host; content:".bg.tf"; endswith; classtype:bad-unknown; sid:2013833; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.ru.tf domain"; flow:to_server,established; http.host; content:".ru.tf"; endswith; classtype:bad-unknown; sid:2013834; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.pl.tf domain"; flow:to_server,established; http.host; content:".pl.tf"; endswith; classtype:bad-unknown; sid:2013835; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.de.tf domain"; flow:to_server,established; http.host; content:".de.tf"; endswith; classtype:bad-unknown; sid:2013837; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.at.tf domain"; flow:to_server,established; http.host; content:".at.tf"; endswith; classtype:bad-unknown; sid:2013838; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.ch.tf domain"; flow:to_server,established; http.host; content:".ch.tf"; endswith; classtype:bad-unknown; sid:2013839; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.sg.tf domain"; flow:to_server,established; http.host; content:".sg.tf"; endswith; classtype:bad-unknown; sid:2013840; rev:7; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.nl.ai domain"; flow:to_server,established; http.host; content:".nl.ai"; endswith; classtype:bad-unknown; sid:2013841; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.xe.cx domain"; flow:to_server,established; http.host; content:".xe.cx"; endswith; classtype:bad-unknown; sid:2013842; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.orge.pl Domain"; flow:established,to_server; http.host; content:".orge.pl"; endswith; classtype:bad-unknown; sid:2013844; rev:5; metadata:created_at 2011_11_05, updated_at 2020_05_06;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a 3322.org.cn Domain"; flow:to_server,established; http.host; content:".3322.org.cn"; endswith; classtype:bad-unknown; sid:2014289; rev:4; metadata:created_at 2012_02_28, updated_at 2020_05_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO WinHttpRequest (flowbits no alert)"; flow:established,to_server; flowbits:set,et.WinHttpRequest; flowbits:noalert; http.host; content:!".microsoft.com"; endswith; content:!".qq.com"; endswith; http.user_agent; content:"WinHttp.WinHttpRequest"; fast_pattern; classtype:trojan-activity; sid:2019821; rev:9; metadata:created_at 2014_12_01, updated_at 2020_05_13;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible ThousandEyes User-Agent Outbound"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Mozilla/5.0 AppleWebKit/999.0 (KHTML, like Gecko) Chrome/99.0 Safari/999.0|0d 0a|"; fast_pattern; reference:url,thousandeyes.com; classtype:misc-activity; sid:2021025; rev:3; metadata:created_at 2015_04_28, updated_at 2020_05_21;)

alert http any any -> $HTTP_SERVERS any (msg:"ET INFO Possible ThousandEyes User-Agent Inbound"; flow:established,to_server; http.header; content:"User-Agent|3a 20|Mozilla/5.0 AppleWebKit/999.0 (KHTML, like Gecko) Chrome/99.0 Safari/999.0|0d 0a|"; fast_pattern; reference:url,thousandeyes.com; classtype:misc-activity; sid:2021026; rev:3; metadata:created_at 2015_04_28, updated_at 2020_05_21;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE IsDebuggerPresent (Used in Malware Anti-Debugging)"; flow:established,to_client; flowbits:isset,ET.http.binary; http.header; content:!"|0d 0a|x-avast"; file.data; content:"IsDebuggerPresent"; classtype:misc-activity; sid:2015744; rev:5; metadata:created_at 2012_09_28, updated_at 2020_05_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request for ISO File Direct to IP"; flow:established,to_server; http.method; content:"GET"; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}(?:\x3a\d+)?$/"; http.request_line; content:".iso HTTP/1."; fast_pattern; classtype:misc-activity; sid:2030205; rev:2; metadata:attack_target Client_Endpoint, created_at 2020_05_22, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2020_05_22;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO User-Agent (wininet)"; flow:established,to_server; flowbits:set,ET.wininet.UA; flowbits:noalert; http.header; content:"User-Agent|3a 20|wininet|0d 0a|"; classtype:misc-activity; sid:2021311; rev:4; metadata:created_at 2015_06_19, updated_at 2020_05_28;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO possible .jpg download by VBA macro"; flow:established,to_server; flowbits:set,ET.vba-jpg-dl; flowbits:noalert; http.method; content:"GET"; http.uri; content:".jpg"; pcre:"/\.jpg(?:\?\d+)?$/"; http.header; content:"Accept|3a 20|*/*|0d 0a|Accept-Encoding|3a 20|gzip, deflate|0d 0a|User-Agent|3a 20|Mozilla/4.0 (compatible|3b 20|MSIE 7.0|3b 20|Windows NT"; depth:102; fast_pattern; http.header_names; content:!"Referer|0d 0a|"; content:!"Accept-Language|0d 0a|"; classtype:trojan-activity; sid:2022220; rev:3; metadata:created_at 2015_12_05, updated_at 2020_06_09;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO possible .jpg download by VBA macro"; flow:established,to_server; flowbits:set,ET.vba-jpg-dl; flowbits:noalert; http.method; content:"GET"; http.uri; content:".jpg"; http.header; content:"Accept|3a 20|*/*|0d 0a|Accept-Language|3a 20|en-us|0d 0a|Range|3a 20|"; content:"MSIE 7.0|3b 20|Windows NT"; fast_pattern; http.header_names; content:!"Referer|0d 0a|"; classtype:trojan-activity; sid:2022262; rev:4; metadata:created_at 2015_12_15, updated_at 2020_06_10;)

#alert tls any any -> $HTTP_SERVERS any (msg:"ET INFO GnuTLS Cryptographic Flaw Observed (CVE-2020-13777)"; flow:to_server,established; content:"|16|"; startswith; content:"|00 23|"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:2; within:16; fast_pattern; pcre:"/^[\x20-\x7e\r\n]{0,13}[^\x20-\x7e\r\n]/R"; reference:url,corelight.blog/2020/06/11/detecting-gnutls-cve-2020-13777-using-zeek/; classtype:attempted-recon; sid:2030340; rev:2; metadata:created_at 2020_06_15, deployment Perimeter, deployment Internal, former_category INFO, performance_impact Significant, signature_severity Major, updated_at 2020_06_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO ZoneAlarm Download Flowbit Set"; flow:established,to_server; http.uri; content:"pkg"; http.host; content:"zonealarm.com"; endswith; flowbits:set,ET.ZoneAlarm.Site.Download; flowbits:noalert; classtype:misc-activity; sid:2022285; rev:3; metadata:created_at 2015_12_18, updated_at 2020_06_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Windows NT version 1 User-Agent"; flow: established,to_server; http.user_agent; content:"Windows NT 1"; nocase; content:!"0"; within:1; pcre:"/^[^0-9]/R"; classtype:trojan-activity; sid:2015898; rev:5; metadata:created_at 2012_11_20, updated_at 2020_06_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST Request to DuckDNS Domain"; flow:established,to_server; http.method; content:"POST"; http.host; content:".duckdns."; fast_pattern; classtype:bad-unknown; sid:2031581; rev:1; metadata:created_at 2020_07_14, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2020_07_14;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST Request to Suspicious *.ma Domain"; flow:established,to_server; http.method; content:"POST"; http.host; content:".ma"; fast_pattern; endswith; classtype:bad-unknown; sid:2030518; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2020_07_15, deployment Perimeter, former_category INFO, performance_impact Significant, signature_severity Major, tag Phishing, updated_at 2020_07_15;)

#alert tcp $HOME_NET any -> any 53 (msg:"ET INFO Suspicious HTTP GET Request on Port 53 Outbound"; flow:established,to_server; content:"GET|20|"; startswith; content:"|20|HTTP|2f|"; distance:0; within:50; fast_pattern; classtype:bad-unknown; sid:2030520; rev:1; metadata:affected_product Windows_DNS_server, created_at 2020_07_15, former_category INFO, performance_impact Significant, signature_severity Informational, updated_at 2020_08_20;)

#alert tcp any 53 -> [$HOME_NET,$HTTP_SERVERS,$DNS_SERVERS] any (msg:"ET INFO Suspicious HTTP GET Request on Port 53 Inbound"; flow:established,to_server; content:"GET|20|"; startswith; content:"|20|HTTP|2f|"; distance:0; within:50; fast_pattern; classtype:bad-unknown; sid:2030521; rev:1; metadata:affected_product Windows_DNS_server, created_at 2020_07_15, former_category INFO, performance_impact Significant, signature_severity Informational, updated_at 2020_08_20;)

#alert tcp $HOME_NET any -> any 53 (msg:"ET INFO Suspicious HTTP POST Request on Port 53 Outbound"; flow:established,to_server; content:"POST|20|"; startswith; content:"|20|HTTP|2f|"; distance:0; within:50; classtype:bad-unknown; sid:2030522; rev:2; metadata:affected_product Windows_DNS_server, created_at 2020_07_15, former_category INFO, performance_impact Significant, signature_severity Informational, updated_at 2020_08_20;)

#alert tcp any 53 -> [$HOME_NET,$HTTP_SERVERS,$DNS_SERVERS] any (msg:"ET INFO Suspicious HTTP POST Request on Port 53 Inbound"; flow:established,to_server; content:"POST|20|"; startswith; content:"|20|HTTP|2f|"; distance:0; within:50; fast_pattern; classtype:bad-unknown; sid:2030523; rev:2; metadata:affected_product Windows_DNS_server, created_at 2020_07_15, former_category INFO, performance_impact Significant, signature_severity Informational, updated_at 2020_08_20;)

alert tcp any any -> any 53 (msg:"ET INFO Possible NOP Sled Observed in Large DNS over TCP Packet M1"; flow:established,to_server; dsize:>1200; content:"|90 90 90 90 90 90 90 90|"; fast_pattern; classtype:attempted-admin; sid:2030524; rev:1; metadata:affected_product Windows_DNS_server, created_at 2020_07_15, former_category INFO, performance_impact Significant, signature_severity Informational, updated_at 2020_07_15;)

alert tcp any 53 -> any any (msg:"ET INFO Possible NOP Sled Observed in Large DNS over TCP Packet M2"; flow:established,from_server; dsize:>1200; content:"|90 90 90 90 90 90 90 90|"; fast_pattern; classtype:attempted-admin; sid:2030525; rev:1; metadata:affected_product Windows_DNS_server, created_at 2020_07_15, former_category INFO, performance_impact Significant, signature_severity Informational, updated_at 2020_07_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Outbound RRSIG DNS Query Observed"; content:"|00 00 2e 00 01|"; fast_pattern; classtype:bad-unknown; sid:2030555; rev:1; metadata:created_at 2020_07_17, updated_at 2020_07_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Symantec Download Flowbit Set"; flow:established,to_server; flowbits:set,ET.Symantec.Site.Download; flowbits:noalert; http.host; content:".symantec.com"; pcre:"/^(?:\x3a\d{1,5})?$/R"; classtype:misc-activity; sid:2023067; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2016_08_16, deployment Perimeter, performance_impact Low, signature_severity Minor, updated_at 2020_07_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Unconfigured nginx Access"; flow:from_server,established; http.stat_code; content:"200"; file.data; content:"|3C|title|3E|Welcome to nginx|213C2F|title|3E|"; classtype:bad-unknown; sid:2023668; rev:3; metadata:attack_target Client_Endpoint, created_at 2016_12_19, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2020_08_03;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE - Served Inline HTTP"; flow:to_client,established; http.header; content:"Content-Disposition"; nocase; content:"inline"; nocase; file.data; content:"MZ"; depth:2; fast_pattern; classtype:misc-activity; sid:2014519; rev:8; metadata:created_at 2012_04_06, updated_at 2020_08_03;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Windows Update/Microsoft FP Flowbit"; flow:established,to_server; flowbits:set,ET.INFO.WindowsUpdate; flowbits:noalert; http.host; content:".windowsupdate.com"; endswith; classtype:trojan-activity; sid:2023818; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2017_02_01, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2020_08_04;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Opera Adblocker Update Flowbit Set"; flow:established,to_server; flowbits:set,ET.opera.adblock; flowbits:noalert; http.host; content:"get.geo.opera.com.global.prod.fastly.net"; bsize:40; classtype:not-suspicious; sid:2024006; rev:3; metadata:created_at 2017_02_22, deployment Perimeter, performance_impact Low, signature_severity Informational, updated_at 2020_08_04;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.dns-free.ru Domain"; flow:to_server,established; http.host; content:".dns-free.com"; endswith; classtype:bad-unknown; sid:2022380; rev:4; metadata:created_at 2016_01_20, updated_at 2020_08_04;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.dyn-dns.ru Domain"; flow:to_server,established; http.host; content:".dyn-dns.ru"; endswith; classtype:bad-unknown; sid:2022379; rev:4; metadata:created_at 2016_01_20, updated_at 2020_08_04;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.dnsip.ru Domain"; flow:to_server,established; http.host; content:".dnsip.ru"; endswith; classtype:bad-unknown; sid:2022378; rev:3; metadata:created_at 2016_01_20, former_category INFO, updated_at 2020_08_04;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.dnsalias.ru Domain"; flow:to_server,established; http.host; content:".dnsalias.ru"; endswith; classtype:bad-unknown; sid:2022377; rev:4; metadata:created_at 2016_01_20, former_category INFO, updated_at 2020_08_04;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS UA starting with Mozilla/8"; flow:established,to_server; http.user_agent; content:"Mozilla/8"; nocase; depth:9; classtype:bad-unknown; sid:2016693; rev:6; metadata:created_at 2013_04_02, updated_at 2020_08_04;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO ARM File Requested via WGET (set)"; flow:to_server,established; flowbits:set,ET.armwget; flowbits:noalert; http.method; content:"GET"; http.uri; pcre:"/\.(?:arm(?:5n|7)?|m(?:ips|psl))$/"; http.user_agent; content:"Wget/"; depth:5; fast_pattern; classtype:policy-violation; sid:2024240; rev:3; metadata:attack_target Client_Endpoint, created_at 2017_04_25, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_08_05;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Bitcoin QR Code Generated via Btcfrog.com"; flow:established,to_server; http.uri; content:"/qr/bitcoinPNG.php?address="; fast_pattern; http.host; content:"www.btcfrog.com"; bsize:15; classtype:coin-mining; sid:2024292; rev:3; metadata:attack_target Client_Endpoint, created_at 2017_05_12, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, updated_at 2020_08_06;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO BitNinja IO Security Check"; flow:established,to_client; http.stat_code; content:"403"; http.header; content:"BitNinja Captcha Server"; fast_pattern; file.data; content:"<title>Waiting for the redirectiron..."; classtype:misc-activity; sid:2030694; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2020_08_17, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2020_08_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious no-ip Domain"; dns.query; content:".no-ip."; classtype:bad-unknown; sid:2013743; rev:5; metadata:created_at 2011_10_05, former_category HUNTING, updated_at 2020_08_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *.dyndns. Domain"; dns.query; content:".dyndns."; nocase; classtype:misc-activity; sid:2012758; rev:6; metadata:created_at 2011_05_02, updated_at 2020_08_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.dyndns.* domain"; flow:established,to_server; http.host; content:".dyndns."; fast_pattern; content:!"checkip."; pcre:"/\.dyndns\.(biz|info|org|tv)$/"; classtype:bad-unknown; sid:2013097; rev:9; metadata:created_at 2011_06_22, updated_at 2020_08_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.dyndns-*.com domain"; flow:established,to_server; http.host; content:".dyndns-"; pcre:"/(?:at-home|at-work|blog|free|home|ip|mail|office|pics|remote|server|web|wiki|work)\.com/R"; classtype:bad-unknown; sid:2013096; rev:6; metadata:created_at 2011_06_22, updated_at 2020_08_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a no-ip Domain"; flow:established,to_server; http.host; content:".no-ip.com"; fast_pattern; content:!"www.no-ip.com"; classtype:bad-unknown; sid:2013744; rev:10; metadata:created_at 2011_10_05, updated_at 2020_08_18;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *.duckdns. Domain"; dns.query; content:".duckdns."; nocase; classtype:misc-activity; sid:2022918; rev:3; metadata:created_at 2016_06_27, updated_at 2020_08_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST to WP Theme Directory Without Referer"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/wp-content/themes/"; fast_pattern; pcre:"/^[^&=?]*\/wp-content\/themes\//i"; http.host; content:!"citytv.com"; http.header_names; content:!"Referer"; classtype:bad-unknown; sid:2020822; rev:7; metadata:created_at 2015_03_31, former_category MALWARE, updated_at 2020_08_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Windows NT version 7 User-Agent"; flow:established,to_server; http.user_agent; content:"Windows NT 7"; nocase; fast_pattern; classtype:trojan-activity; sid:2015820; rev:5; metadata:created_at 2012_10_19, updated_at 2020_08_18;)

alert tcp $HOME_NET any -> any 22 (msg:"ET INFO Plaintext SSH Authentication Identified (Encryption set to None)"; flow:established,to_server; content:"|00 00 00|"; content:"|00 00 00|"; within:50; content:"|0e|ssh-connection|00 00 00 08|password|00 00 00 00|"; within:31; content:"|00 00 00 00 00 00 00 00 00|"; distance:0; reference:url,hamwan.org/Standards/Network%20Engineering/Authentication/SSH%20Without%20Encryption.html; classtype:attempted-user; sid:2026643; rev:3; metadata:attack_target Client_and_Server, created_at 2018_11_21, deployment Perimeter, deployment Internal, former_category INFO, performance_impact Low, signature_severity Major, updated_at 2020_08_19;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO EXE - OSX Executable Download - Multi Arch w/Intel"; flow:established,to_client; content:"|0d 0a 0d 0a CA FE BA BE|"; content:"|CE FA ED FE|"; distance:0; content:"__TEXT"; distance:0; classtype:misc-activity; sid:2014514; rev:8; metadata:created_at 2012_04_06, updated_at 2020_08_19;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.top domain"; flow:established,to_server; threshold:type limit, track by_src, count 1, seconds 30; http.host; content:".top"; fast_pattern; pcre:"/^(\x3a\d{1,5})?$/R"; reference:url,www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2023882; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2017_02_07, deployment Perimeter, signature_severity Major, updated_at 2020_08_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO JAR Size Under 30K Size - Potentially Hostile"; flow:established,to_client; http.content_type; content:"application/java-archive"; depth:24; fast_pattern; http.content_len; byte_test:0,<=,30000,0,string,dec; file.data; content:"PK"; within:2; classtype:bad-unknown; sid:2017639; rev:8; metadata:created_at 2013_10_28, updated_at 2020_08_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Base64 Encoded powershell.exe in HTTP Response M1"; flow:established,from_server; http.content_type; content:"text/plain"; startswith; file.data; content:"cG93ZXJzaGVsbC5leG"; fast_pattern; reference:url,otx.alienvault.com/pulse/5a1348416dd9eb0c92d9897a; classtype:bad-unknown; sid:2025238; rev:4; metadata:created_at 2018_01_22, former_category INFO, updated_at 2020_08_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Base64 Encoded powershell.exe in HTTP Response M2"; flow:established,from_server; http.content_type; content:"text/plain"; startswith; file.data; content:"Bvd2Vyc2hlbGwuZXhl"; fast_pattern; reference:url,otx.alienvault.com/pulse/5a1348416dd9eb0c92d9897a; classtype:bad-unknown; sid:2025239; rev:4; metadata:created_at 2018_01_22, updated_at 2020_08_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Base64 Encoded powershell.exe in HTTP Response M3"; flow:established,from_server; http.content_type; content:"text/plain"; startswith; file.data; content:"wb3dlcnNoZWxsLmV4Z"; fast_pattern; reference:url,otx.alienvault.com/pulse/5a1348416dd9eb0c92d9897a; classtype:bad-unknown; sid:2025240; rev:4; metadata:created_at 2018_01_22, updated_at 2020_08_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Secondary Flash Request Seen (no alert)"; flow:established,to_server; flowbits:set,ET.SecondaryFlash.Req; flowbits:noalert; http.referer; content:"/[[DYNAMIC]]/1"; fast_pattern; http.header_names; content:"x-flash-version"; classtype:trojan-activity; sid:2025411; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2018_03_09, deployment Perimeter, former_category INFO, signature_severity Major, tag Sundown_EK, updated_at 2020_08_24;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious User-Agent (CustomStringHere)"; flow:established,to_server; http.user_agent; content:"CustomStringHere"; reference:md5,7a8cb1223e006bc7e70169c060d7057b; classtype:misc-activity; sid:2025436; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2018_03_19, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_08_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO NYU Internet HTTP/SSL Census Scan"; flow:to_server,established; http.user_agent; content:"NYU Internet Census (https://scan.lol|3b 20|research@scan.lol)"; reference:url,scan.lol; classtype:network-scan; sid:2025460; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, created_at 2018_04_03, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_08_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible Rogue LoJack Asset Tracking Agent"; flow:established,to_server; urilen:1; threshold: type limit, count 2, seconds 300, track by_src; http.method; content:"POST"; http.header; content:"TagId|3a 20|"; fast_pattern; content:!".namequery.com|0d 0a|"; reference:url,asert.arbornetworks.com/lojack-becomes-a-double-agent/amp/; classtype:misc-attack; sid:2025553; rev:3; metadata:attack_target Client_Endpoint, created_at 2018_05_02, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_08_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Inbound PowerShell Checking for Virtual Host (Win32_Fan WMI)"; flow:established,from_server; http.stat_code; content:"200"; file.data; content:"Get-WmiObject -Query"; nocase; content:"Select|20|*|20|from|20|win32_fan"; fast_pattern; nocase; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/; classtype:trojan-activity; sid:2026074; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_05, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, tag Enumeration, tag Anti_VM, updated_at 2020_08_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Inbound PowerShell Checking for Virtual Host (MSAcpi_ThermalZoneTemperature WMI)"; flow:established,from_server; http.stat_code; content:"200"; file.data; content:"Get-WmiObject -Query"; nocase; content:"Select|20|*|20|from|20|MSAcpi_ThermalZoneTemperature"; fast_pattern; nocase; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/; classtype:trojan-activity; sid:2026075; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_05, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, tag Enumeration, tag Anti_VM, updated_at 2020_08_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Inbound PowerShell Checking for Virtual Host (Win32_PointingDevice WMI)"; flow:established,from_server; http.stat_code; content:"200"; file.data; content:"Get-WmiObject -Query"; nocase; content:"Select|20|*|20|from|20|Win32_PointingDevice"; fast_pattern; nocase; content:"-contains|20|"; pcre:"/^\x22(?:v(mware|irtual|irtualbox|m\x20ware|box))/Rsi"; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/; classtype:trojan-activity; sid:2026076; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_05, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, tag Enumeration, tag Anti_VM, updated_at 2020_08_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Inbound PowerShell Checking for Virtual Host (Win32_DiskDevice WMI)"; flow:established,from_server; http.stat_code; content:"200"; file.data; content:"Get-WmiObject -Query"; nocase; content:"Select|20|*|20|from|20|Win32_DiskDevice"; fast_pattern; nocase; content:"-contains|20|"; pcre:"/^\x22(?:v(mware|irtual|irtualbox|m\x20ware|box))/Rsi"; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/; classtype:trojan-activity; sid:2026077; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_05, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, tag Enumeration, tag Anti_VM, updated_at 2020_08_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Inbound PowerShell Checking for Virtual Host (Win32_BaseBoard WMI)"; flow:established,from_server; http.stat_code; content:"200"; file.data; content:"Get-WmiObject -Query"; nocase; content:"Select|20|*|20|from|20|Win32_BaseBoard"; fast_pattern; nocase; content:"-contains|20|"; pcre:"/^\x22(?:v(mware|irtual|irtualbox|m\x20ware|box))/Rsi"; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/; classtype:trojan-activity; sid:2026078; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_05, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, tag Enumeration, tag Anti_VM, updated_at 2020_08_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possible System Enumeration via WMI Queries (AntiVirusProduct)"; flow:established,from_server; threshold:type limit, count 1, seconds 60, track by_src; http.stat_code; content:"200"; file.data; content:"On|20|Error|20|Resume|20|Next|0d 0a|"; depth:25; content:"SELECT|20 2a 20|FROM|20|AntiVirusProduct"; distance:0; fast_pattern; nocase; reference:md5,11f792cc617cf5c08603d4da829a1fa9; classtype:policy-violation; sid:2026413; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_26, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag VBS, tag Enumeration, updated_at 2020_08_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possible System Enumeration via WMI Queries (AntiSpywareProduct)"; flow:established,from_server; threshold:type limit, count 1, seconds 60, track by_src; http.stat_code; content:"200"; file.data; content:"On|20|Error|20|Resume|20|Next|0d 0a|"; depth:25; content:"SELECT|20 2a 20|FROM|20|AntiSpywareProduct"; distance:0; fast_pattern; nocase; reference:md5,11f792cc617cf5c08603d4da829a1fa9; classtype:policy-violation; sid:2026414; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_26, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag VBS, tag Enumeration, updated_at 2020_08_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possible System Enumeration via WMI Queries (FirewallProduct)"; flow:established,from_server; threshold:type limit, count 1, seconds 60, track by_src; http.stat_code; content:"200"; file.data; content:"On|20|Error|20|Resume|20|Next|0d 0a|"; depth:25; content:"SELECT|20 2a 20|FROM|20|FirewallProduct"; distance:0; fast_pattern; nocase; reference:md5,11f792cc617cf5c08603d4da829a1fa9; classtype:policy-violation; sid:2026415; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_26, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag VBS, tag Enumeration, updated_at 2020_08_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO maas.io Image Download Flowbit Set"; flow:established,to_server; flowbits:set,ET.Maas.Site.Download; flowbits:noalert; http.method; content:"GET"; http.user_agent; content:"maas/2.3."; http.host; content:"images.maas.io"; classtype:trojan-activity; sid:2026747; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2019_01_02, former_category INFO, signature_severity Informational, updated_at 2020_08_27;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO External Host Probing for ChromeCast Devices"; flow:established,to_server; urilen:18; http.method; content:"GET"; http.uri; content:"/setup/eureka_info"; fast_pattern; reference:url,www.theverge.com/2019/1/2/18165386/pewdiepie-chromecast-hack-tseries-google-chromecast-smart-tv; classtype:trojan-activity; sid:2026758; rev:3; metadata:attack_target IoT, created_at 2019_01_04, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Minor, tag Enumeration, updated_at 2020_08_27;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO [eSentire] Possible Kali Linux Updates"; flow:established,to_server; http.method; content:"GET"; http.user_agent; content:"APT-HTTP|2f|"; http.host; content:"kali.org"; fast_pattern; pcre:"/^[a-z0-9.]+\.kali\.org/"; classtype:policy-violation; sid:2025627; rev:3; metadata:affected_product Linux, attack_target Client_Endpoint, created_at 2018_06_25, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_08_28;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request with Double Cache-Control"; flow:established,to_server; http.header; content:"Cache-Control|3a 20|no-cache|0d 0a|Cache-Control|3a 20|no-cache"; classtype:trojan-activity; sid:2027207; rev:2; metadata:created_at 2019_04_16, updated_at 2020_08_28;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO GET Minimal HTTP Headers Flowbit Set"; flow:established,to_server; flowbits:set,min.gethttp; flowbits:noalert; http.method; content:"GET"; http.header_names; content:!"Accept"; content:!"If-"; content:!"Referer"; content:!"User-Agent"; content:!"Content"; classtype:bad-unknown; sid:2016537; rev:4; metadata:created_at 2013_03_06, updated_at 2020_08_28;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO PowerShell Internet Connectivity Check via Network GUID Inbound"; flow:established,from_server; http.stat_code; content:"200"; file.data; content:"|3a 3a|GetTypeFromCLSID"; nocase; content:"|5b|Guid|5d 27 7b|DCB00C01-570F-4A9B-8D69-199FDBA5723B|7d 27 29 29|.IsConnectedToInternet"; distance:0; nocase; fast_pattern; reference:md5,036180b14dce975a055e62902e5f3567; classtype:trojan-activity; sid:2027394; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2019_05_29, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag PowerShell, tag T1086, updated_at 2020_08_31;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Hiloti Style GET to PHP with invalid terse MSIE headers"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".php?"; http.user_agent; content:"Mozilla/4.0|20|(compatible|3b 20|MSIE|20|"; content:!"8"; within:1; content:"|3b 20|Windows|20|NT|20|"; distance:0; content:!"SlimBrowser"; http.host; content:!".taobao.com"; content:!".dict.cn"; content:!".avg.com"; content:!".weather.hao.360.cn"; content:!"es.f.360.cn"; http.header_names; content:"|0d 0a|User-Agent|0d 0a|Host|0d 0a|"; depth:20; fast_pattern; classtype:trojan-activity; sid:2012612; rev:18; metadata:created_at 2011_03_31, former_category TROJAN, updated_at 2020_08_31;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for a Suspicious *.noc.su domain"; dns.query; content:".noc.su"; fast_pattern; classtype:bad-unknown; sid:2012901; rev:5; metadata:created_at 2011_05_31, former_category HUNTING, updated_at 2020_09_01;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query to a *.slyip.net Dynamic DNS Domain"; dns.query; content:".try2check.me"; fast_pattern; nocase; classtype:bad-unknown; sid:2014508; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_01;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO McAfee AV Download - Set"; flow:established,to_server; flowbits:set,ET.Mcafee.Site.Download; flowbits:noalert; http.method; content:"GET"; http.user_agent; content:"McHttpH"; fast_pattern; http.host; content:"download.mcafee.com"; classtype:not-suspicious; sid:2027945; rev:2; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_09_05, deployment Perimeter, former_category INFO, performance_impact Moderate, signature_severity Informational, updated_at 2020_09_01;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious HTTP POST to 404.php"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/404.php"; endswith; fast_pattern; classtype:misc-activity; sid:2030819; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2020_09_01, deployment Perimeter, signature_severity Informational, updated_at 2020_11_12;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUSPICIOUS Java Request to DNSDynamic Dynamic DNS Domain"; flow:to_server,established; http.user_agent; content:"Java/1."; http.host; pcre:"/\.(?:d(?:ns(?:d(?:ynamic\.(?:com|net)|\.(?:info|me))|api\.info|get\.org|53\.biz)|dns01\.com)|(?:f(?:lashserv|e100|tp21)|adultdns|mysq1|wow64)\.net|(?:(?:ima|voi)p01|(?:user|ole)32|kadm5)\.com|t(?:tl60\.(?:com|org)|empors\.com|ftpd\.net)|s(?:sh(?:01\.com|22\.net)|ql01\.com)|http(?:(?:s443|01)\.com|80\.info)|n(?:s360\.info|tdll\.net)|x(?:ns01\.com|64\.me)|craftx\.biz)(\x3a\d{1,5})?$/"; classtype:bad-unknown; sid:2016583; rev:6; metadata:created_at 2013_03_15, former_category HUNTING, updated_at 2020_09_02;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Imposter USPS Domain"; flow:established,to_server; http.host; content:".usps.com."; fast_pattern; classtype:bad-unknown; sid:2015848; rev:5; metadata:created_at 2012_10_27, updated_at 2020_09_03;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Java Request to DynDNS Pro Dynamic DNS Domain"; flow:to_server,established; http.user_agent; content:"Java/1."; http.host; pcre:"/\.(?:i(?:s(?:-(?:a(?:-(?:(?:(?:h(?:ard-work|unt)e|financialadviso)r|d(?:e(?:mocrat|signer)|octor)|t(?:e(?:acher|chie)|herapist)|r(?:epublican|ockstar)|n(?:ascarfan|urse)|anarchist|musician)\.com|c(?:(?:(?:ubicle-sla|onservati)ve|pa)\.com|a(?:ndidate\.org|terer\.com)|hef\.(?:com|net|org)|elticsfan\.org)|l(?:i(?:ber(?:tarian|al)\.com|nux-user\.org)|(?:a(?:ndscap|wy)er|lama)\.com)|p(?:(?:ersonaltrain|hotograph|lay)er\.com|a(?:inter\.com|tsfan\.org))|b(?:(?:(?:ookkeep|logg)er|ulls-fan)\.com|ruinsfan\.org)|s(?:o(?:cialist\.com|xfan\.org)|tudent\.com)|g(?:eek\.(?:com|net|org)|(?:reen|uru)\.com)|knight\.org)|n-(?:a(?:c(?:t(?:ress|or)|countant)|(?:narch|rt)ist)|en(?:tertain|gine)er)\.com)|(?:into-(?:(?:car(?:toon)?|game)s|anime)|(?:(?:not-)?certifie|with-theban)d|uberleet|gone)\.com|(?:very-(?:(?:goo|ba)d|sweet|evil|nice)|found)\.org|s(?:aved\.org|lick\.com)|l(?:eet\.com|ost\.org)|by\.us)|a-(?:geek\.(?:com|net|org)|hockeynut\.com)|t(?:eingeek|mein)\.de|smarterthanyou\.com)|n-the-band\.net|amallama\.com)|f(?:rom-(?:(?:i[adln]|w[aivy]|o[hkr]|[hr]i|d[ce]|k[sy]|p[ar]|s[cd]|t[nx]|v[at]|fl|ga|ut)\.com|m(?:[adinost]\.com|e\.org)|n(?:[cdehjmv]\.com|y\.net)|a(?:[klr]\.com|z\.net)|c(?:[at]\.com|o\.net)|la\.net)|or(?:-(?:(?:(?:mor|som|th)e|better)\.biz|our\.info)|got\.h(?:er|is)\.name)|uettertdasnetz\.de|tpaccess\.cc)|s(?:e(?:l(?:ls(?:-(?:for-(?:less|u)\.com|it\.net)|yourhome\.org)|fip\.(?:info|biz|com|net|org))|rve(?:bbs\.(?:com|net|org)|ftp\.(?:net|org)|game\.org))|(?:aves-the-whales|pace-to-rent|imple-url)\.com|crapp(?:er-site\.net|ing\.cc)|tuff-4-sale\.(?:org|us)|hacknet\.nu)|d(?:o(?:es(?:ntexist\.(?:com|org)|-it\.net)|ntexist\.(?:com|net|org)|omdns\.(?:com|org))|yn(?:a(?:lias\.(?:com|net|org)|thome\.net)|-o-saur\.com|dns\.ws)|ns(?:alias\.(?:com|net|org)|dojo\.(?:com|net|org))|vrdns\.org)|h(?:o(?:me(?:linux\.(?:com|net|org)|unix\.(?:com|net|org)|(?:\.dyn)?dns\.org|ftp\.(?:net|org)|ip\.net)|bby-site\.(?:com|org))|ere-for-more\.info|am-radio-op\.net)|b(?:log(?:dns\.(?:com|net|org)|site\.org)|(?:uyshouses|roke-it)\.net|arrel?l-of-knowledge\.info|oldlygoingnowhere\.org|etter-than\.tv)|g(?:o(?:tdns\.(?:com|org)|\.dyndns\.org)|ame-(?:server\.cc|host\.org)|et(?:myip\.com|s-it\.net)|roks-th(?:is|e)\.info)|e(?:st-(?:(?:a-la-ma(?:is|si)|le-patr)on|mon-blogueur)\.com|ndof(?:internet\.(?:net|org)|theinternet\.org))|l(?:e(?:btimnetz|itungsen)\.de|ikes(?:candy|-pie)\.com|and-4-sale\.us)|m(?:i(?:sconfused\.org|ne\.nu)|yp(?:hotos\.cc|ets\.ws)|erseine\.nu)|w(?:ebhop\.(?:info|biz|net|org)|ritesthisblog\.com|orse-than\.tv)|t(?:eaches-yoga\.com|raeumtgerade\.de|hruhere\.net)|k(?:icks-ass\.(?:net|org)|nowsitall\.info)|o(?:ffice-on-the\.net|n-the-web\.tv)|(?:neat-url|cechire)\.com|podzone\.(?:net|org)|at-band-camp\.net|readmyblog\.org)(\x3a\d{1,5})?$/"; classtype:bad-unknown; sid:2016580; rev:6; metadata:created_at 2013_03_15, updated_at 2020_09_03;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET INFO User-Agent (python-requests) Inbound to Webserver"; flow:established,to_server; http.user_agent; content:"python-requests/"; classtype:attempted-recon; sid:2017515; rev:6; metadata:created_at 2013_09_25, updated_at 2020_09_13;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.uni.cc domain"; flow:to_server,established; http.host; content:".uni.cc"; endswith; classtype:bad-unknown; sid:2013438; rev:5; metadata:created_at 2011_08_19, updated_at 2020_09_14;)

alert http any any -> any any (msg:"ET INFO WinHttp AutoProxy Request wpad.dat Possible BadTunnel"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/wpad.dat"; fast_pattern; endswith; reference:url,tools.ietf.org/html/draft-ietf-wrec-wpad-01; reference:url,ietf.org/rfc/rfc1002.txt; classtype:protocol-command-decode; sid:2022913; rev:5; metadata:created_at 2016_06_23, updated_at 2020_09_14;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to 3322.org Domain"; dns.query; content:".3322.org"; nocase; endswith; reference:url,isc.sans.edu/diary.html?storyid=3266; reference:url,isc.sans.edu/diary.html?storyid=5710; reference:url,google.com/safebrowsing/diagnostic?site=3322.org/; reference:url,www.mywot.com/en/scorecard/3322.org; classtype:misc-activity; sid:2012171; rev:9; metadata:created_at 2011_01_12, updated_at 2020_09_14;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.pw domain"; flow:established,to_server; http.host; content:".pw"; fast_pattern; endswith; content:!"u.pw"; depth:4; endswith; classtype:bad-unknown; sid:2016777; rev:14; metadata:created_at 2013_04_20, updated_at 2020_09_14;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Executable Download from dotted-quad Host"; flow:established,to_server; http.uri; content:".exe"; endswith; nocase; http.host; content:"."; offset:1; depth:3; content:"."; within:4; content:"."; within:4; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}$/"; http.request_line; content:".exe HTTP/1."; fast_pattern; classtype:trojan-activity; sid:2016141; rev:7; metadata:created_at 2013_01_03, updated_at 2020_09_14;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.flnet.org Domain"; dns.query; content:".flnet.org"; nocase; endswith; classtype:bad-unknown; sid:2014500; rev:7; metadata:created_at 2012_04_05, updated_at 2020_09_14;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a 3322.net Domain *.3322.net"; flow:established,to_server; http.host; content:".3322.net"; endswith; classtype:misc-activity; sid:2014788; rev:9; metadata:created_at 2012_05_19, updated_at 2020_09_14;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.dtdns.net Domain"; dns.query; content:".dtdns.net"; nocase; endswith; classtype:bad-unknown; sid:2014492; rev:7; metadata:created_at 2012_04_05, updated_at 2020_09_14;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.dtdns.net domain"; flow:to_server,established; http.host; content:".dtdns.net"; endswith; classtype:bad-unknown; sid:2013684; rev:6; metadata:created_at 2011_09_22, updated_at 2020_09_14;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.dtdns.net Domain"; flow:established,to_server; http.host; content:".dtdns.net"; endswith; classtype:bad-unknown; sid:2014493; rev:9; metadata:created_at 2012_04_05, updated_at 2020_09_14;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious *.myftp.biz Domain"; dns.query; content:".myftp.biz"; nocase; endswith; classtype:bad-unknown; sid:2013823; rev:5; metadata:created_at 2011_11_05, former_category HUNTING, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to 3322.net Domain *.8800.org"; threshold: type limit, count 1, track by_src, seconds 300; dns.query; content:".8800.org"; endswith; classtype:misc-activity; sid:2014784; rev:8; metadata:created_at 2012_05_18, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to Abused Domain *.mooo.com"; flow:established,to_server; http.host; content:".mooo.com"; endswith; classtype:bad-unknown; sid:2015634; rev:6; metadata:created_at 2012_08_16, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query Domain .bit"; dns.query; content:".bit"; nocase; endswith; reference:url,www.normanshark.com/blog/necurs-cc-domains-non-censorable/; classtype:bad-unknown; sid:2017645; rev:5; metadata:created_at 2013_10_30, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to 3322.net Domain *.8866.org"; dns.query; content:".8866.org"; endswith; nocase; reference:url,isc.sans.edu/diary.html?storyid=6739; reference:url,google.com/safebrowsing/diagnostic?site=8866.org/; reference:url,www.mywot.com/en/scorecard/8866.org; classtype:misc-activity; sid:2012738; rev:8; metadata:created_at 2011_04_28, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.3d-game.com Domain"; dns.query; content:".3d-game.com"; nocase; endswith; classtype:bad-unknown; sid:2014478; rev:7; metadata:created_at 2012_04_05, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .cz.cc Domain"; dns.query; content:".cz.cc"; endswith; nocase; reference:url,sign.kaffenews.com/?p=104; classtype:bad-unknown; sid:2011410; rev:6; metadata:created_at 2010_09_28, former_category HUNTING, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Connection To DDNS Domain Hopto.org"; flow:established,to_server; http.host; content:".hopto.org"; fast_pattern; endswith; reference:url,blogs.cisco.com/security/dynamic-detection-of-malicious-ddns/; reference:url,labs.umbrella.com/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/; classtype:bad-unknown; sid:2018216; rev:5; metadata:created_at 2014_03_05, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for a Suspicious *.cu.cc domain"; dns.query; content:".cu.cc"; nocase; endswith; classtype:bad-unknown; sid:2013172; rev:5; metadata:created_at 2011_07_02, former_category HUNTING, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.osa.pl domain"; flow:established,to_server; http.host; content:".osa.pl"; endswith; classtype:bad-unknown; sid:2014037; rev:6; metadata:created_at 2011_12_22, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query to Free Hosting Domain (freevnn . com)"; dns.query; content:".freevnn.com"; nocase; endswith; reference:md5,18c1c99412549815bdb89c36316243a7; classtype:bad-unknown; sid:2024235; rev:5; metadata:created_at 2017_04_21, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Minor, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.suroot.com Domain"; flow:established,to_server; http.host; content:".suroot.com"; endswith; classtype:bad-unknown; sid:2014511; rev:7; metadata:created_at 2012_04_05, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Connection To DDNS Domain Myvnc.com"; flow:established,to_server; http.host; content:".myvnc.com"; endswith; reference:url,blogs.cisco.com/security/dynamic-detection-of-malicious-ddns/; reference:url,labs.umbrella.com/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/; classtype:bad-unknown; sid:2018213; rev:5; metadata:created_at 2014_03_05, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.bbsindex.com Domain"; dns.query; content:".bbsindex.com"; nocase; endswith; classtype:bad-unknown; sid:2014484; rev:7; metadata:created_at 2012_04_05, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to Abused Domain *.mooo.com"; threshold: type limit, count 1, track by_src, seconds 300; dns.query; content:".mooo.com"; nocase; endswith; classtype:misc-activity; sid:2015633; rev:5; metadata:created_at 2012_08_16, updated_at 2020_09_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for a Suspicious *.co.tv domain"; dns.query; content:".co.tv"; nocase; endswith; classtype:bad-unknown; sid:2012956; rev:6; metadata:created_at 2011_06_08, former_category HUNTING, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a 3322.net Domain *.3322.org"; flow:established,to_server; http.host; content:".3322.org"; endswith; classtype:misc-activity; sid:2013213; rev:8; metadata:created_at 2011_07_06, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.sytes.net Domain"; flow:established,to_server; http.host; content:".sytes.net"; endswith; classtype:bad-unknown; sid:2018219; rev:9; metadata:created_at 2012_03_05, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.tc domain"; flow:established,to_server; http.host; content:".tc"; endswith; classtype:bad-unknown; sid:2013535; rev:7; metadata:created_at 2011_09_06, updated_at 2020_09_15;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST Request to Suspicious *.gdn Domain"; flow:established,to_server; http.method; content:"POST"; http.host; content:".gdn"; fast_pattern; endswith; classtype:bad-unknown; sid:2025097; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST Request to Suspicious *.gq domain"; flow:established,to_server; http.method; content:"POST"; http.host; content:".gq"; fast_pattern; endswith; classtype:bad-unknown; sid:2025100; rev:3; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST Request to Suspicious *.ga Domain"; flow:established,to_server; http.method; content:"POST"; http.host; content:".ga"; fast_pattern; endswith; classtype:bad-unknown; sid:2025101; rev:3; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST Request to Suspicious *.ml Domain"; flow:established,to_server; http.method; content:"POST"; http.host; content:".ml"; fast_pattern; endswith; classtype:bad-unknown; sid:2025102; rev:3; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST Request to Suspicious *.cf Domain"; flow:established,to_server; http.method; content:"POST"; http.host; content:".cf"; fast_pattern; endswith; classtype:bad-unknown; sid:2025103; rev:3; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .ga Domain"; threshold: type limit, count 1, track by_src, seconds 120; dns.query; content:".ga"; nocase; endswith; classtype:bad-unknown; sid:2025105; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .ml Domain"; threshold: type limit, count 1, track by_src, seconds 120; dns.query; content:".ml"; nocase; endswith; classtype:bad-unknown; sid:2025106; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .cf Domain"; threshold: type limit, count 1, track by_src, seconds 120; dns.query; content:".cf"; nocase; endswith; classtype:bad-unknown; sid:2025107; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .gq Domain"; threshold: type limit, count 1, track by_src, seconds 120; dns.query; content:".gq"; nocase; endswith; classtype:bad-unknown; sid:2025104; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Domain (*.ga) in TLS SNI"; flow:established,to_server; threshold: type limit, count 1, track by_src, seconds 120; tls.sni; content:".ga"; endswith; fast_pattern; nocase; classtype:bad-unknown; sid:2025109; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Domain (*.gq) in TLS SNI"; flow:established,to_server; threshold: type limit, count 1, track by_src, seconds 120; tls.sni; content:".gq"; endswith; fast_pattern; nocase; classtype:bad-unknown; sid:2025108; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Domain (*.ml) in TLS SNI"; flow:established,to_server; threshold: type limit, count 1, track by_src, seconds 120; tls.sni; content:".ml"; endswith; fast_pattern; nocase; classtype:bad-unknown; sid:2025110; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Domain (*.cf) in TLS SNI"; flow:established,to_server; threshold: type limit, count 1, track by_src, seconds 120; tls.sni; content:".cf"; endswith; fast_pattern; nocase; classtype:bad-unknown; sid:2025111; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Domain (*.gdn) in TLS SNI"; flow:established,to_server; threshold: type limit, count 1, track by_src, seconds 120; tls.sni; content:".gdn"; endswith; fast_pattern; nocase; classtype:bad-unknown; sid:2025112; rev:4; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO MIPSEL File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".mipsel"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025122; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO MIPS File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".mips"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025123; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO ARM File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".arm"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025124; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO ARM7 File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".arm7"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025125; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO x86 File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".x86"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025126; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO m68k File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".m68k"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025127; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SPARC File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".sparc"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025128; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO POWERPC File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".powerpc"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025129; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO X86_64 File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".x86_64"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025130; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SUPERH File Download Request from IP Address"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".superh"; nocase; endswith; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:bad-unknown; sid:2025131; rev:3; metadata:attack_target IoT, created_at 2017_12_05, former_category INFO, updated_at 2020_09_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .gr.com Domain (gr .com in DNS Lookup)"; dns.query; content:".gr.com"; endswith; reference:url,www.domain.gr.com; classtype:bad-unknown; sid:2025146; rev:5; metadata:created_at 2017_12_12, former_category HUNTING, updated_at 2020_09_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed Free Hosting Domain (*.000webhostapp .com in DNS Lookup)"; dns.query; content:".000webhostapp.com"; nocase; endswith; classtype:not-suspicious; sid:2026657; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2018_03_16, deployment Perimeter, former_category INFO, performance_impact Moderate, signature_severity Informational, updated_at 2020_09_16;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed SSL Cert for Free Hosting Domain (*.000webhostapp .com)"; flow:established,to_client; tls.cert_subject; content:"CN=*.000webhostapp.com"; nocase; endswith; classtype:not-suspicious; sid:2026658; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2018_03_16, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2020_09_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .myq-see .com DDNS Domain"; dns.query; content:".myq-see.com"; nocase; endswith; classtype:policy-violation; sid:2025560; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2018_05_07, deployment Perimeter, former_category INFO, performance_impact Moderate, signature_severity Major, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Generic 000webhostapp.com POST 2018-09-27 (set)"; flow:to_server,established; flowbits:set,ET.000webhostpost; flowbits:noalert; http.method; content:"POST"; http.host; content:".000webhostapp.com"; endswith; fast_pattern; classtype:misc-activity; sid:2026420; rev:3; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2018_09_27, deployment Perimeter, former_category INFO, signature_severity Minor, tag Phishing, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO GET to Puu.sh for TXT File with Minimal Headers"; flow:to_server,established; http.method; content:"GET"; http.uri; content:".txt"; nocase; endswith; http.host; content:"puu.sh"; depth:6; endswith; fast_pattern; http.header_names; content:"|0d 0a|Host|0d 0a|Connection|0d 0a 0d 0a|"; depth:22; endswith; classtype:bad-unknown; sid:2026569; rev:3; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2018_11_02, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_11_10;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Minimal HTTP GET Request to Bit.ly"; flow:established,to_server; http.method; content:"GET"; http.start; content:"HTTP/1.1|0d 0a|Host|3a 20|bit.ly|0d 0a|Connection|3a 20|Keep-Alive|0d 0a 0d 0a|"; endswith; fast_pattern; classtype:bad-unknown; sid:2026674; rev:3; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2018_11_29, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP POST Request to Suspicious *.icu domain"; flow:established,to_server; http.method; content:"POST"; http.host; content:".icu"; fast_pattern; endswith; classtype:bad-unknown; sid:2026887; rev:3; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2019_02_06, deployment Perimeter, former_category HUNTING, signature_severity Minor, tag Phishing, updated_at 2020_09_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .icu Domain"; threshold: type limit, count 1, track by_src, seconds 120; dns.query; content:".icu"; nocase; endswith; classtype:bad-unknown; sid:2026888; rev:3; metadata:attack_target Client_Endpoint, created_at 2019_02_06, deployment Perimeter, former_category HUNTING, signature_severity Minor, updated_at 2020_09_16;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Domain (*.icu) in TLS SNI"; flow:established,to_server; threshold: type limit, count 1, track by_src, seconds 120; tls.sni; content:".icu"; endswith; fast_pattern; nocase; classtype:bad-unknown; sid:2026889; rev:3; metadata:attack_target Client_Endpoint, created_at 2019_02_06, deployment Perimeter, former_category HUNTING, signature_severity Minor, updated_at 2020_09_16;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Wget Request for Executable"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".exe"; endswith; nocase; http.user_agent; content:"Wget/"; depth:5; fast_pattern; classtype:bad-unknown; sid:2027076; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2019_03_12, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_11_11;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible MSXMLHTTP Request to Dotted Quad"; flow:to_server,established; flowbits:set,et.MS.XMLHTTP.ip.request; flowbits:noalert; http.start; content:"HTTP/1.1|0d 0a|Accept|3a 20|*/*|0d 0a|Accept-Encoding|3a 20|gzip, deflate|0d 0a|User-Agent|3a 20|Mozilla/4.0 (compatible|3b 20|MSIE 7.0|3b 20|Windows NT"; fast_pattern; http.header_names; content:!"UA-CPU"; content:!"Cookie"; content:!"Referer"; content:!"Accept-Language"; http.host; pcre:"/^(?:\d{1,3}\.){3}\d{1,3}/"; classtype:misc-activity; sid:2022054; rev:6; metadata:created_at 2015_11_10, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any 53 (msg:"ET INFO DYNAMIC_DNS Query to *.myddns.me Domain"; flow:established,to_server; threshold: type limit, count 1, track by_src, seconds 120; dns.query; content:".myddns.me"; nocase; endswith; classtype:policy-violation; sid:2027287; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_25, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, tag DynamicDNS, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.myddns.me Domain"; flow:established,to_server; http.host; content:".myddns.me"; endswith; classtype:policy-violation; sid:2027288; rev:3; metadata:attack_target Client_Endpoint, created_at 2019_04_25, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, tag DynamicDNS, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *.autoddns .com Domain"; threshold: type limit, count 1, track by_src, seconds 120; dns.query; content:".autoddns.com"; nocase; endswith; classtype:policy-violation; sid:2027299; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_30, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, tag DynamicDNS, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.autoddns.com Domain"; flow:established,to_server; http.host; content:".autoddns.com"; endswith; classtype:policy-violation; sid:2027300; rev:3; metadata:attack_target Client_Endpoint, created_at 2019_04_30, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, tag DynamicDNS, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO AutoIt User-Agent Downloading ZIP"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".zip"; nocase; endswith; http.user_agent; content:"AutoIt"; depth:6; endswith; fast_pattern; http.header_names; content:!"Referer"; classtype:trojan-activity; sid:2027360; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2019_05_17, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious shell .now .sh Domain"; dns.query; content:"shell.now.sh"; nocase; endswith; reference:url,www.lacework.com/blog-attacks-exploiting-confluence; classtype:misc-attack; sid:2027367; rev:4; metadata:affected_product Linux, attack_target Client_Endpoint, created_at 2019_05_19, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Generic - Mozilla 4.0 EXE Request"; flow:established,to_server; urilen:6<>15; http.uri; content:".exe"; endswith; http.user_agent; content:"Mozilla/4.0"; fast_pattern; bsize:11; classtype:unknown; sid:2020705; rev:7; metadata:created_at 2015_03_18, former_category MALWARE, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO AutoIt User Agent Executable Request"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".exe"; nocase; endswith; http.user_agent; content:"AutoIt"; depth:6; endswith; fast_pattern; http.header_names; content:!"Referer"; classtype:trojan-activity; sid:2019935; rev:7; metadata:created_at 2014_12_15, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, tag AutoIt, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a 3322.net Domain *.8866.org"; flow:established,to_server; http.host; content:"8866.org"; endswith; reference:url,www.mywot.com/en/scorecard/8866.org; classtype:misc-activity; sid:2013220; rev:7; metadata:created_at 2011_07_06, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .biz TLD"; dns.query; content:".biz"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027863; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .okinawa TLD"; dns.query; content:".okinawa"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027864; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .cloud TLD"; dns.query; content:".cloud"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027865; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .desi TLD"; dns.query; content:".desi"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027866; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .life TLD"; dns.query; content:".life"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027867; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .work TLD"; dns.query; content:".work"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027868; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .ryukyu TLD"; dns.query; content:".ryukyu"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027869; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .world TLD"; dns.query; content:".world"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027870; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to .fit TLD"; dns.query; content:".fit"; nocase; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027871; rev:4; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2019_08_13, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.okinawa Domain"; flow:established,to_server; http.host; content:".okinawa"; fast_pattern; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027873; rev:4; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.cloud Domain"; flow:established,to_server; http.host; content:".cloud"; fast_pattern; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027874; rev:4; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.desi Domain"; flow:established,to_server; http.host; content:".desi"; fast_pattern; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027875; rev:4; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.life Domain"; flow:established,to_server; http.host; content:".life"; fast_pattern; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027876; rev:4; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.work Domain"; flow:established,to_server; http.host; content:".work"; fast_pattern; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027877; rev:4; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.ryukyu Domain"; flow:established,to_server; http.host; content:".ryukyu"; fast_pattern; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027878; rev:4; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.world Domain"; flow:established,to_server; http.host; content:".world"; fast_pattern; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027879; rev:4; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to Suspicious *.fit Domain"; flow:established,to_server; http.host; content:".fit"; fast_pattern; endswith; reference:url,www.spamhaus.org/statistics/tlds/; classtype:bad-unknown; sid:2027880; rev:4; metadata:created_at 2019_08_13, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query to a Suspicious *.vv.cc domain"; dns.query; content:".vv.cc"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2012826; rev:5; metadata:created_at 2011_05_19, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .co.be Domain"; dns.query; content:".co.be"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013124; rev:7; metadata:created_at 2011_06_29, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .net.tf Domain"; dns.query; content:".net.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013847; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .eu.tf Domain"; dns.query; content:".eu.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013848; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .int.tf Domain"; dns.query; content:".int.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013849; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .edu.tf Domain"; dns.query; content:".edu.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013850; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .us.tf Domain"; dns.query; content:".us.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013851; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .ca.tf Domain"; dns.query; content:".ca.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013852; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .bg.tf Domain"; dns.query; content:".bg.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013853; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .ru.tf Domain"; dns.query; content:".ru.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013854; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .pl.tf Domain"; dns.query; content:".pl.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013855; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .cz.tf Domain"; dns.query; content:".cz.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013856; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .de.tf Domain"; dns.query; content:".de.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013857; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .at.tf Domain"; dns.query; content:".at.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013858; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .ch.tf Domain"; dns.query; content:".ch.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013859; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .sg.tf Domain"; dns.query; content:".sg.tf"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013860; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .nl.ai Domain"; dns.query; content:".nl.ai"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013861; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .xe.cx Domain"; dns.query; content:".xe.cx"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013862; rev:5; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for Suspicious .noip.cn Domain"; dns.query; content:".noip.cn"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013970; rev:5; metadata:created_at 2011_11_28, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .ch.vu Domain"; dns.query; content:".ch.vu"; fast_pattern; nocase; endswith; reference:url,google.com/safebrowsing/diagnostic?site=ch.vu; classtype:bad-unknown; sid:2014285; rev:8; metadata:created_at 2012_02_28, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious *.ez-dns.com Domain"; dns.query; content:".ez-dns.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013845; rev:6; metadata:created_at 2011_11_05, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious *.dyndns-web.com Domain"; dns.query; content:".dyndns-web.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013863; rev:7; metadata:created_at 2011_11_07, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query for Suspicious .dyndns-at-home.com Domain"; dns.query; content:".dyndns-at-home.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013971; rev:7; metadata:created_at 2011_11_28, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.4irc.com Domain"; dns.query; content:".4irc.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014480; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.b0ne.com Domain"; dns.query; content:".b0ne.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014482; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.chatnook.com Domain"; dns.query; content:".chatnook.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014486; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.darktech.org Domain"; dns.query; content:".darktech.org"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014488; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.deaftone.com Domain"; dns.query; content:".deaftone.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014490; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.effers.com Domain"; dns.query; content:".effers.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014494; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.etowns.net Domain"; dns.query; content:".etowns.net"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014496; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.etowns.org Domain"; dns.query; content:".etowns.org"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014498; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.gotgeeks.com Domain"; dns.query; content:".gotgeeks.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014502; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.scieron.com Domain"; dns.query; content:".scieron.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014504; rev:8; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.slyip.com Domain"; dns.query; content:".slyip.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014506; rev:9; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.suroot.com Domain"; dns.query; content:".suroot.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014510; rev:9; metadata:created_at 2012_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to 3322.net Domain *.2288.org"; threshold: type limit, count 1, track by_src, seconds 300; dns.query; content:".2288.org"; fast_pattern; endswith; classtype:misc-activity; sid:2014779; rev:10; metadata:created_at 2012_05_18, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to 3322.net Domain *.3322.net"; threshold: type limit, count 1, track by_src, seconds 300; dns.query; content:".3322.net"; fast_pattern; endswith; classtype:misc-activity; sid:2014781; rev:10; metadata:created_at 2012_05_18, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to 3322.net Domain *.6600.org"; threshold: type limit, count 1, track by_src, seconds 300; dns.query; content:".6600.org"; fast_pattern; endswith; classtype:misc-activity; sid:2014782; rev:10; metadata:created_at 2012_05_18, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to 3322.net Domain *.7766.org"; threshold: type limit, count 1, track by_src, seconds 300; dns.query; content:".7766.org"; fast_pattern; endswith; classtype:misc-activity; sid:2014783; rev:10; metadata:created_at 2012_05_18, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to 3322.net Domain *.9966.org"; threshold: type limit, count 1, track by_src, seconds 300; dns.query; content:".9966.org"; fast_pattern; endswith; classtype:misc-activity; sid:2014786; rev:9; metadata:created_at 2012_05_18, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to dns-stuff.com Domain *.dns-stuff.com"; dns.query; content:".dns-stuff.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2014868; rev:6; metadata:created_at 2012_06_07, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for a Suspicious *.be.ma domain"; dns.query; content:".be.ma"; fast_pattern; endswith; classtype:bad-unknown; sid:2012902; rev:7; metadata:created_at 2011_05_31, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Query for a Suspicious *.upas.su domain"; dns.query; content:".upas.su"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2015550; rev:5; metadata:created_at 2012_07_31, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .co.cc Domain"; dns.query; content:".co.cc"; fast_pattern; nocase; endswith; reference:url,sign.kaffenews.com/?p=104; classtype:bad-unknown; sid:2011409; rev:7; metadata:created_at 2010_09_28, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.mrbasic.com Domain"; dns.query; content:".mrbasic.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2018366; rev:6; metadata:created_at 2014_04_05, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *.passinggas.net Domain (Sitelutions)"; dns.query; content:".passinggas.net"; nocase; fast_pattern; endswith; classtype:bad-unknown; sid:2018810; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *.myredirect.us Domain (Sitelutions)"; dns.query; content:".myredirect.us"; nocase; fast_pattern; endswith; classtype:bad-unknown; sid:2018812; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *.rr.nu Domain (Sitelutions)"; dns.query; content:".rr.nu"; nocase; fast_pattern; endswith; classtype:bad-unknown; sid:2018814; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *.kwik.to Domain (Sitelutions)"; dns.query; content:".kwik.to"; nocase; endswith; fast_pattern; classtype:bad-unknown; sid:2018816; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *.myfw.us Domain (Sitelutions)"; dns.query; content:".myfw.us"; nocase; endswith; fast_pattern; classtype:bad-unknown; sid:2018818; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *ontheweb.nu Domain (Sitelutions)"; dns.query; content:".ontheweb.nu"; nocase; endswith; classtype:bad-unknown; sid:2018820; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *isthebe.st Domain (Sitelutions)"; dns.query; content:".isthebe.st"; nocase; endswith; classtype:bad-unknown; sid:2018822; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *byinter.net Domain (Sitelutions)"; dns.query; content:".byinter.net"; nocase; endswith; classtype:bad-unknown; sid:2018824; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *findhere.org Domain (Sitelutions)"; dns.query; content:".findhere.org"; nocase; endswith; classtype:bad-unknown; sid:2018826; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *onthenetas.com Domain (Sitelutions)"; dns.query; content:".onthenetas.com"; nocase; endswith; classtype:bad-unknown; sid:2018828; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *uglyas.com Domain (Sitelutions)"; dns.query; content:".uglyas.com"; nocase; endswith; classtype:bad-unknown; sid:2018830; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *assexyas.com Domain (Sitelutions)"; dns.query; content:".assexyas.com"; nocase; endswith; classtype:bad-unknown; sid:2018832; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *passas.us Domain (Sitelutions)"; dns.query; content:".passas.us"; nocase; endswith; classtype:bad-unknown; sid:2018834; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *atthissite.com Domain (Sitelutions)"; dns.query; content:"athissite.com"; nocase; endswith; classtype:bad-unknown; sid:2018836; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *athersite.com Domain (Sitelutions)"; dns.query; content:"athersite.com"; nocase; endswith; classtype:bad-unknown; sid:2018838; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *isgre.at Domain (Sitelutions)"; dns.query; content:".isgre.at"; nocase; endswith; classtype:bad-unknown; sid:2018840; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *lookin.at Domain (Sitelutions)"; dns.query; content:".lookin.at"; nocase; endswith; classtype:bad-unknown; sid:2018842; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *bestdeals.at Domain (Sitelutions)"; dns.query; content:".bestdeals.at"; nocase; endswith; classtype:bad-unknown; sid:2018844; rev:5; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to *lowestprices Domain (Sitelutions)"; dns.query; content:".lowestprices.at"; nocase; endswith; classtype:bad-unknown; sid:2018846; rev:7; metadata:created_at 2014_07_30, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query to a Suspicious *.orge.pl Domain"; dns.query; content:".orge.pl"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2013843; rev:6; metadata:created_at 2011_11_05, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious *.dnsip.ru Domain"; dns.query; content:".dnsip.ru"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2022382; rev:5; metadata:created_at 2016_01_20, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious *.dyn-dns.ru Domain"; dns.query; content:".dyn-dns.ru"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2022383; rev:6; metadata:created_at 2016_01_20, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious *.dnsalias.ru Domain"; dns.query; content:".dnsalias.ru"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2022381; rev:6; metadata:created_at 2016_01_20, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious *.dns-free.ru Domain"; dns.query; content:".dns-free.com"; fast_pattern; nocase; endswith; classtype:bad-unknown; sid:2022384; rev:6; metadata:created_at 2016_01_20, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for a Suspicious *.ae.am domain"; dns.query; content:".ae.am"; fast_pattern; endswith; classtype:bad-unknown; sid:2012900; rev:7; metadata:created_at 2011_05_31, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for a Suspicious *.qc.cx domain"; dns.query; content:".qc.cx"; fast_pattern; endswith; classtype:bad-unknown; sid:2012903; rev:7; metadata:created_at 2011_05_31, former_category HUNTING, updated_at 2020_09_17;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a Suspicious dynapoint.pw Domain"; dns.query; content:"dynapoint.pw"; depth:12; endswith; fast_pattern; classtype:bad-unknown; sid:2022876; rev:5; metadata:created_at 2016_06_08, former_category HUNTING, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Windows OS Submitting USB Metadata to Microsoft"; flow:established,to_server; threshold:type limit, seconds 300, count 1, track by_src; http.method; content:"POST"; http.uri; content:"metadata.svc"; endswith; http.header; content:"/DeviceMetadataService/GetDeviceMetadata|22 0d 0a|"; http.user_agent; content:"MICROSOFT_DEVICE_METADATA_RETRIEVAL_CLIENT"; depth:42; endswith; fast_pattern; classtype:misc-activity; sid:2025275; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2018_01_31, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Minor, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO SimpleTDS go.php (sid)"; flow:established,to_server; http.uri; content:"/go.php?sid="; fast_pattern; classtype:trojan-activity; sid:2015675; rev:5; metadata:created_at 2012_09_05, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Windows NT version 9 User-Agent"; flow:established,to_server; http.user_agent; content:"Windows NT 9"; nocase; fast_pattern; classtype:trojan-activity; sid:2015822; rev:5; metadata:created_at 2012_10_19, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Windows NT version 2 User-Agent"; flow: established,to_server; http.user_agent; content:"Windows NT 2"; nocase; fast_pattern; classtype:trojan-activity; sid:2015899; rev:5; metadata:created_at 2012_11_20, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Windows NT version 3 User-Agent"; flow: established,to_server; http.user_agent; content:"Windows NT 3"; nocase; fast_pattern; classtype:trojan-activity; sid:2015900; rev:6; metadata:created_at 2012_11_20, updated_at 2020_09_17;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO PDF - Acrobat Enumeration - pdfobject.js"; flow:established,to_server; http.uri; content:"/pdfobject.js"; fast_pattern; classtype:misc-activity; sid:2016765; rev:4; metadata:created_at 2013_04_18, updated_at 2020_09_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO myobfuscate.com Encoded Script Calling home"; flow:to_server,established; http.uri; content:"/?getsrc="; content:"&url="; http.header; content:"api.myobfuscate.com|0d|"; nocase; fast_pattern; classtype:misc-activity; sid:2016802; rev:6; metadata:created_at 2013_05_01, updated_at 2020_09_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible Chrome Plugin install"; flow:to_server,established; http.uri; content:"|2f|crx|2f|blobs"; nocase; fast_pattern; http.user_agent; content:"|20|Chrome/"; reference:url,blogs.technet.com/b/mmpc/archive/2013/05/10/browser-extension-hijacks-facebook-profiles.aspx; classtype:bad-unknown; sid:2016847; rev:5; metadata:created_at 2013_05_14, updated_at 2020_09_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible Firefox Plugin install"; flow:to_server,established; http.uri; content:".xpi"; nocase; fast_pattern; endswith; http.user_agent; content:"|20|Firefox/"; reference:url,research.zscaler.com/2012/09/how-to-install-silently-malicious.html; classtype:bad-unknown; sid:2016846; rev:6; metadata:created_at 2013_05_14, updated_at 2020_09_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Connection To DDNS Domain Adultdns.net"; flow:established,to_server; http.host; content:".adultdns.net"; fast_pattern; endswith; reference:url,blogs.cisco.com/security/dynamic-detection-of-malicious-ddns/; reference:url,labs.umbrella.com/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/; classtype:bad-unknown; sid:2018211; rev:4; metadata:created_at 2014_03_05, updated_at 2020_09_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Connection To DDNS Domain Servehttp.com"; flow:established,to_server; http.host; content:".servehttp.com"; fast_pattern; endswith; reference:url,blogs.cisco.com/security/dynamic-detection-of-malicious-ddns/; reference:url,labs.umbrella.com/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/; classtype:bad-unknown; sid:2018212; rev:4; metadata:created_at 2014_03_05, updated_at 2020_09_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Connection To DDNS Domain Redirectme.net"; flow:established,to_server; http.host; content:".redirectme.net"; fast_pattern; endswith; reference:url,blogs.cisco.com/security/dynamic-detection-of-malicious-ddns/; reference:url,labs.umbrella.com/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/; classtype:bad-unknown; sid:2018214; rev:4; metadata:created_at 2014_03_05, updated_at 2020_09_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Connection To DDNS Domain Zapto.org"; flow:established,to_server; http.host; content:".zapto.org"; fast_pattern; endswith; reference:url,blogs.cisco.com/security/dynamic-detection-of-malicious-ddns/; reference:url,labs.umbrella.com/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/; classtype:bad-unknown; sid:2018215; rev:4; metadata:created_at 2014_03_05, updated_at 2020_09_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Connection To DDNS Domain serveblog.net"; flow:established,to_server; http.host; content:".serveblog.net"; fast_pattern; endswith; reference:url,isc.sans.edu/diary/Fiesta!/17739; classtype:bad-unknown; sid:2018217; rev:4; metadata:created_at 2014_03_05, updated_at 2020_09_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Connection To DDNS Domain myftp.com"; flow:established,to_server; http.host; content:".myftp.com"; fast_pattern; endswith; reference:url,isc.sans.edu/diary/Fiesta!/17739; classtype:bad-unknown; sid:2018218; rev:4; metadata:created_at 2014_03_05, updated_at 2020_09_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Windows NT version 8 User-Agent"; flow: established,to_server; http.user_agent; content:"Windows NT 8"; nocase; fast_pattern; content:!"NOKIA"; nocase; classtype:trojan-activity; sid:2015821; rev:6; metadata:created_at 2012_10_19, updated_at 2020_09_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.mrbasic.com Domain"; flow:established,to_server; http.host; content:".mrbasic.com"; fast_pattern; endswith; classtype:bad-unknown; sid:2018365; rev:4; metadata:created_at 2014_04_05, updated_at 2020_09_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.passinggas.net Domain (Sitelutions)"; flow:established,to_server; http.host; content:".passinggas.net"; fast_pattern; endswith; classtype:bad-unknown; sid:2018809; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.myredirect.us Domain (Sitelutions)"; flow:established,to_server; http.host; content:".myredirect.us"; fast_pattern; endswith; classtype:bad-unknown; sid:2018811; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.rr.nu Domain (Sitelutions)"; flow:established,to_server; http.host; content:".rr.nu"; fast_pattern; endswith; classtype:bad-unknown; sid:2018813; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.kwik.to Domain (Sitelutions)"; flow:established,to_server; http.host; content:".kwik.to"; fast_pattern; endswith; classtype:bad-unknown; sid:2018815; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.myfw.us Domain (Sitelutions)"; flow:established,to_server; http.host; content:".myfw.us"; fast_pattern; endswith; classtype:bad-unknown; sid:2018817; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.ontheweb.nu Domain (Sitelutions)"; flow:established,to_server; http.host; content:".ontheweb.nu"; fast_pattern; endswith; classtype:bad-unknown; sid:2018819; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.isthebe.st Domain (Sitelutions)"; flow:established,to_server; http.host; content:".isthebe.st"; fast_pattern; endswith; classtype:bad-unknown; sid:2018821; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.byinter.net Domain (Sitelutions)"; flow:established,to_server; http.host; content:".byinter.net"; fast_pattern; endswith; classtype:bad-unknown; sid:2018823; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.findhere.org Domain (Sitelutions)"; flow:established,to_server; http.host; content:".findhere.org"; fast_pattern; endswith; classtype:bad-unknown; sid:2018825; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.onthenetas.com Domain (Sitelutions)"; flow:established,to_server; http.host; content:".onthenetas.com"; fast_pattern; endswith; classtype:bad-unknown; sid:2018827; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.uglyas.com Domain (Sitelutions)"; flow:established,to_server; http.host; content:".uglyas.com"; fast_pattern; endswith; classtype:bad-unknown; sid:2018829; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.assexyas.com Domain (Sitelutions)"; flow:established,to_server; http.host; content:".assexyas.com"; fast_pattern; endswith; classtype:bad-unknown; sid:2018831; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.passas.us Domain (Sitelutions)"; flow:established,to_server; http.host; content:".passas.us"; fast_pattern; endswith; classtype:bad-unknown; sid:2018833; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.athissite.com Domain (Sitelutions)"; flow:established,to_server; http.host; content:".athissite.com"; fast_pattern; endswith; classtype:bad-unknown; sid:2018835; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.athersite.com Domain (Sitelutions)"; flow:established,to_server; http.host; content:".athersite.com"; fast_pattern; endswith; classtype:bad-unknown; sid:2018837; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.isgre.at Domain (Sitelutions)"; flow:established,to_server; http.host; content:".isgre.at"; fast_pattern; endswith; classtype:bad-unknown; sid:2018839; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.lookin.at Domain (Sitelutions)"; flow:established,to_server; http.host; content:".lookin.at"; fast_pattern; endswith; classtype:bad-unknown; sid:2018841; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.bestdeals.at Domain (Sitelutions)"; flow:established,to_server; http.host; content:".bestdeals.at"; fast_pattern; endswith; classtype:bad-unknown; sid:2018843; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to *.lowestprices.at Domain (Sitelutions)"; flow:established,to_server; http.host; content:".lowestprices.at"; fast_pattern; endswith; classtype:bad-unknown; sid:2018845; rev:4; metadata:created_at 2014_07_30, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.de.ms domain"; flow:to_server,established; http.host; content:".de.ms"; fast_pattern; endswith; classtype:bad-unknown; sid:2013378; rev:5; metadata:created_at 2011_08_08, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.eu.tf domain"; flow: to_server,established; http.host; content:".eu.tf"; fast_pattern; endswith; classtype:bad-unknown; sid:2013828; rev:5; metadata:created_at 2011_11_05, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a .noip.cn domain"; flow:to_server,established; http.host; content:".noip.cn"; fast_pattern; endswith; classtype:bad-unknown; sid:2013969; rev:5; metadata:created_at 2011_11_28, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.upas.su domain"; flow:to_server,established; http.host; content:".upas.su"; fast_pattern; endswith; classtype:bad-unknown; sid:2015551; rev:5; metadata:created_at 2012_07_31, updated_at 2020_09_25;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO .exe download with no referer (noalert)"; flow:established,to_server; flowbits:set,exe.no.referer; flowbits:noalert; http.uri; content:".exe"; fast_pattern; http.header_names; content:!"Referer|0d 0a|"; classtype:bad-unknown; sid:2020573; rev:4; metadata:created_at 2015_02_27, former_category INFO, updated_at 2020_09_29;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M1 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^1\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"1"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021067; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M2 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^2\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"2"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021068; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M3 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^3\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"3"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021069; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M4 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^4\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"4"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021070; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M5 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^5\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"5"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021071; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M6 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^6\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"6"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021072; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M7 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^7\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"7"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021073; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M8 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^8\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"8"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021074; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host M9 (noalert)"; flowbits:set,http.dottedquadhost; flowbits:noalert; flow:to_server,established; http.host; pcre:"/^9\d{0,2}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; content:"9"; fast_pattern; depth:1; classtype:bad-unknown; sid:2021075; rev:4; metadata:created_at 2015_05_08, updated_at 2020_09_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible MSXMLHTTP Request (exe) unset (no exe)"; flow:to_server,established; flowbits:isset,et.MS.XMLHTTP.no.exe.request; flowbits:unset,et.MS.XMLHTTP.no.exe.request; flowbits:noalert; http.uri; content:".exe"; nocase; fast_pattern; classtype:misc-activity; sid:2022264; rev:6; metadata:created_at 2015_12_15, updated_at 2020_10_05;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible MSXMLHTTP Request (msi) unset (no exe)"; flow:to_server,established; flowbits:isset,et.MS.XMLHTTP.no.exe.request; flowbits:unset,et.MS.XMLHTTP.no.exe.request; flowbits:noalert; http.uri; content:".msi"; nocase; fast_pattern; classtype:misc-activity; sid:2022265; rev:6; metadata:created_at 2015_12_15, updated_at 2020_10_05;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible MSXMLHTTP Request (msp) unset (no exe)"; flow:to_server,established; flowbits:isset,et.MS.XMLHTTP.no.exe.request; flowbits:unset,et.MS.XMLHTTP.no.exe.request; flowbits:noalert; http.uri; content:".msp"; nocase; fast_pattern; classtype:misc-activity; sid:2022266; rev:6; metadata:created_at 2015_12_15, updated_at 2020_10_05;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Purported MSIE 7 with terse HTTP Headers GET to PHP"; flow:established,to_server; http.uri; content:".php"; nocase; http.user_agent; content:"Mozilla/4.0 (compatible|3b 20|MSIE 7.0|3b 20|Windows NT 5.1)"; depth:50; endswith; fast_pattern; http.protocol; content:"HTTP/1.1"; http.header_names; content:"|0d 0a|User-Agent|0d 0a|Host|0d 0a|"; depth:20; content:"Cache-Control|0d 0a 0d 0a|"; distance:0; classtype:trojan-activity; sid:2012384; rev:5; metadata:created_at 2011_02_27, updated_at 2020_10_19;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Microsoft Connection Test"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/connecttest.txt"; bsize:16; http.host; content:"www.msftconnecttest.com"; bsize:26; classtype:bad-unknown; sid:2031071; rev:1; metadata:created_at 2020_10_21, former_category INFO, performance_impact Low, updated_at 2020_10_21;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed Lets Encrypt Certificate for Suspicious TLD (.top)"; flow:established,to_client; tls.cert_subject; content:".top"; endswith; tls.cert_issuer; content:"Lets Encrypt"; classtype:bad-unknown; sid:2029257; rev:3; metadata:created_at 2020_01_13, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Minor, updated_at 2020_10_27;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Flowbit set for POST to Quicken Updater"; flow:established,to_server; flowbits:set,ET.QuickenUpdater; flowbits:noalert; http.method; content:"POST"; http.header; content:"quicken.com|0d 0a|"; content:"Date|3a|"; http.user_agent; content:"InetClntApp"; fast_pattern; depth:11; classtype:misc-activity; sid:2022803; rev:4; metadata:created_at 2016_05_11, updated_at 2020_10_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible WinHttpRequest (no .exe)"; flow:to_server,established; flowbits:set,et.MS.WinHttpRequest.no.exe.request; flowbits:noalert; http.uri; content:!".exe"; nocase; content:!".msi"; nocase; content:!".msp"; nocase; http.user_agent; content:"Mozilla/4.0 (compatible|3b 20|Win32|3b 20|WinHttp.WinHttpRequest.5)"; fast_pattern; http.header_names; content:!"Cookie|0d 0a|"; content:!"Referer|0d 0a|"; content:!"Accept-Language|0d 0a|"; content:!"UA-CPU|0d 0a|"; classtype:misc-activity; sid:2022652; rev:4; metadata:created_at 2016_03_24, updated_at 2020_11_02;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO IE7UA No Cookie No Referer"; flow:to_server,established; flowbits:set,et.IE7.NoRef.NoCookie; flowbits:noalert; http.user_agent; content:"Mozilla/4.0 (compatible|3b 20|MSIE 7.0|3b|"; fast_pattern; startswith; http.header_names; content:!"Referer|0d 0a|"; content:!"Cookie|0d 0a|"; classtype:bad-unknown; sid:2023670; rev:5; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2016_12_19, deployment Perimeter, malware_family Trojan_Kwampirs, signature_severity Major, updated_at 2020_11_04;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Possible MSXMLHTTP Request (no .exe)"; flow:to_server,established; flowbits:set,et.MS.XMLHTTP.no.exe.request; flowbits:noalert; http.uri; content:!".exe"; nocase; content:!".msi"; nocase; content:!".msp"; nocase; http.start; content:"HTTP/1.1|0d 0a|Accept|3a 20|*/*|0d 0a|Accept-Encoding|3a 20|gzip, deflate|0d 0a|User-Agent|3a 20|Mozilla/4.0 (compatible|3b 20|MSIE 7.0|3b 20|Windows NT"; fast_pattern; http.header_names; content:"|0d 0a|Accept|0d 0a|Accept-Encoding|0d 0a|User-Agent|0d 0a|Host|0d 0a|"; depth:45; content:!"Cookie|0d 0a|"; content:!"Referer|0d 0a|"; content:!"Accept-Language|0d 0a|"; content:!"UA-CPU|0d 0a|"; classtype:misc-activity; sid:2022049; rev:5; metadata:created_at 2015_11_09, updated_at 2020_11_05;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Java .jar request to dotted-quad domain"; flow:established,to_server; http.uri; content:".jar"; fast_pattern; http.header; content:"|20|Java/1"; http.host; pcre:"/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; classtype:bad-unknown; sid:2015483; rev:6; metadata:created_at 2012_07_18, updated_at 2020_11_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Suspicious Outbound SIG DNS Query"; content:"|00 00 18 00 01|"; fast_pattern; dns.query; pcre:"/^\d/"; classtype:bad-unknown; sid:2030547; rev:2; metadata:created_at 2020_07_16, former_category INFO, performance_impact Significant, signature_severity Informational, updated_at 2020_11_17;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possibly Malicious VBS Writing to Persistence Registry Location"; flow:established,from_server; http.stat_code; content:"200"; file.data; content:"on|20|error|20|resume|20|next"; nocase; content:".regwrite|20 22|"; distance:0; content:"|5c|software|5c|microsoft|5c|windows|5c|currentversion|5c|run"; within:80; fast_pattern; reference:md5,cac1aedbcb417dcba511db5caae4b8c0; classtype:trojan-activity; sid:2026427; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2018_09_28, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Major, tag VBS, tag Persistence, updated_at 2020_11_18;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DNS Query for Suspicious .gdn Domain"; dns.query; content:".gdn"; nocase; endswith; classtype:bad-unknown; sid:2025098; rev:5; metadata:created_at 2017_12_03, former_category HUNTING, updated_at 2020_11_19;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Vulnerable iTunes Version 10.6.x"; flow:established,to_server; flowbits:set,ET.iTunes.vuln; flowbits:noalert; http.header; pcre:"/^User-Agent\x3a\x20iTunes\/10\.6\.[0-1]/m"; http.user_agent; content:"iTunes/10.6."; depth:12; classtype:policy-violation; sid:2014954; rev:12; metadata:created_at 2012_06_25, updated_at 2020_11_19;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.gdn)"; flow:from_server,established; tls.cert_subject; content:".gdn"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031223; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.ml)"; flow:from_server,established; tls.cert_subject; content:".ml"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031224; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.gq)"; flow:from_server,established; tls.cert_subject; content:".gq"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031225; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.ga)"; flow:from_server,established; tls.cert_subject; content:".ga"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031226; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.cf)"; flow:from_server,established; tls.cert_subject; content:".cf"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031227; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.xyz)"; flow:from_server,established; tls.cert_subject; content:".xyz"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031228; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.icu)"; flow:from_server,established; tls.cert_subject; content:".icu"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031229; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.top)"; flow:from_server,established; tls.cert_subject; content:".top"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031230; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL SSL/TLS Certificate"; flow:from_server,established; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031231; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Observed ZeroSSL Certificate for Suspicious TLD (.pw)"; flow:from_server,established; tls.cert_subject; content:".pw"; endswith; tls.cert_issuer; content:"ZeroSSL"; classtype:bad-unknown; sid:2031232; rev:1; metadata:created_at 2020_11_23, updated_at 2020_11_23;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO McAfee AV Download (set)"; flow:established,to_server; flowbits:set,ET.Mcafee.Site.Download; flowbits:noalert; http.method; content:"GET"; http.user_agent; content:"McAfee ePO"; fast_pattern; http.host; content:"update.nai.com"; classtype:not-suspicious; sid:2031317; rev:1; metadata:created_at 2020_12_11, former_category INFO, performance_impact Low, updated_at 2020_12_11;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Generic 302 Redirect to Google"; flow:from_server,established; http.stat_code; content:"302"; http.location; content:"https://google.com"; fast_pattern; startswith; classtype:misc-activity; sid:2030594; rev:3; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2020_07_24, deployment Perimeter, signature_severity Informational, updated_at 2020_12_11;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Doc Requesting Remote Template (.dotm)"; flow:established,to_server; flowbits:set,ETPRO.Maldoc.dotm; http.method; content:"GET"; http.uri; content:".dotm"; endswith; fast_pattern; http.user_agent; content:"|3b 20|ms-office|3b 20|MSOffice|20|"; classtype:bad-unknown; sid:2031379; rev:2; metadata:attack_target Client_Endpoint, created_at 2020_12_14, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2020_12_14;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO 3XX redirect to data URL"; flow:from_server,established; http.stat_code; content:"3"; depth:1; http.location; content:"data|3a|"; fast_pattern; depth:5; classtype:misc-activity; sid:2015674; rev:6; metadata:created_at 2012_09_05, updated_at 2020_12_22;)

alert http any any -> $HOME_NET any (msg:"ET INFO PHP Xdebug Extension Query Parameter (XDEBUG_SESSION_START)"; flow:established,to_server; http.uri; content:"?XDEBUG_SESSION_START="; classtype:web-application-activity; sid:2031499; rev:1; metadata:attack_target Web_Server, created_at 2021_01_08, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_01_08;)

alert http any any -> $HOME_NET any (msg:"ET INFO Spring Boot Actuator Health Check Request"; flow:established,to_server; http.uri; content:"/actuator/health"; endswith; classtype:web-application-activity; sid:2031500; rev:1; metadata:attack_target Web_Server, created_at 2021_01_08, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_01_08;)

alert http any any -> $HOME_NET any (msg:"ET INFO Netlink GPON Login Attempt (GET)"; flow:established,to_server; http.uri; content:"/boaform/admin/formLogin"; fast_pattern; content:"username="; content:"psd="; classtype:attempted-admin; sid:2031501; rev:2; metadata:created_at 2021_01_08, updated_at 2021_01_08;)

alert http any any -> $HOME_NET any (msg:"ET INFO Request to Hidden Environment File"; flow:established,to_server; http.uri; content:"/.env"; endswith; classtype:misc-attack; sid:2031502; rev:1; metadata:created_at 2021_01_08, updated_at 2021_01_08;)

alert http any any -> $HOME_NET any (msg:"ET INFO Liferay JSON Web Services Invoker"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/api/jsonws/invoke"; http.content_type; content:"application/json"; classtype:web-application-activity; sid:2031503; rev:1; metadata:affected_product Web_Server_Applications, attack_target Web_Server, created_at 2021_01_08, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_01_08;)

alert http any any -> $HOME_NET any (msg:"ET INFO Apache Solr System Information Request"; flow:established,to_server; http.uri; content:"/solr/admin/info/system"; classtype:web-application-activity; sid:2031504; rev:1; metadata:affected_product Apache_Solr, attack_target Web_Server, created_at 2021_01_08, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_01_08;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Minimal HTTP GET Request to cl .ly"; flow:established,to_server; http.method; content:"GET"; http.start; content:"HTTP/1.1|0d 0a|Host|3a 20|cl.ly|0d 0a|Connection|3a 20|Keep-Alive|0d 0a 0d 0a|"; endswith; fast_pattern; classtype:bad-unknown; sid:2031588; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2021_01_29, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_02_03;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Minimal HTTP GET Request to rebrand .ly"; flow:established,to_server; http.method; content:"GET"; http.start; content:"HTTP/1.1|0d 0a|Host|3a 20|rebrand.ly|0d 0a|Connection|3a 20|Keep-Alive|0d 0a 0d 0a|"; endswith; fast_pattern; classtype:misc-activity; sid:2031589; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_01_29, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_02_03;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO NoxPlayer Simulator Update Activity"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/api/posttoken/simulator/"; startswith; fast_pattern; content:"/update"; endswith; http.host; content:"api.bignox.com"; bsize:14; reference:url,www.welivesecurity.com/2021/02/01/operation-nightscout-supply-chain-attack-online-gaming-asia/; classtype:policy-violation; sid:2031594; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_02_01, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_02_01;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO MP3 with ID3 in HTTP Flowbit Set"; flow:from_server,established; file.data; content:"ID3"; within:3; content:"|FB FF|"; distance:0; flowbits:set,ET.mp3.in.http; flowbits:noalert; classtype:not-suspicious; sid:2025986; rev:2; metadata:affected_product Adobe_Flash, created_at 2018_08_10, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_03_08;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Dotted Quad Host PS1 Request"; flow:established,from_client; flowbits:isset,http.dottedquadhost; flowbits:set,http.dottedquadhost.ps1; flowbits:unset,http.dottedquadhost; http.request_line; content:".ps1 HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2027259; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_04_23, former_category INFO, performance_impact Significant, signature_severity Minor, updated_at 2021_03_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO PS1 Powershell File Request"; flow:established,from_client; flowbits:set,ET.PS.Download; http.request_line; content:".ps1 HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2032162; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_18, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_03_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO PSM1 Powershell File Request"; flow:established,from_client; flowbits:set,ET.PS.Download; http.request_line; content:".psm1 HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2032163; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_18, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_03_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO PSD1 Powershell File Request"; flow:established,from_client; flowbits:set,ET.PS.Download; http.request_line; content:".psd1 HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2032164; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_18, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_03_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO PS1XML Powershell File Request"; flow:established,from_client; flowbits:set,ET.PS.Download; http.request_line; content:".ps1xml HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2032165; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_18, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_03_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO PSSC Powershell File Request"; flow:established,from_client; flowbits:set,ET.PS.Download; http.request_line; content:".pssc HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2032166; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_18, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_03_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO PSRC Powershell File Request"; flow:established,from_client; flowbits:set,ET.PS.Download; http.request_line; content:".psrc HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2032167; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_18, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_03_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO CDXML Powershell File Request"; flow:established,from_client; flowbits:set,ET.PS.Download; http.request_line; content:".cdxml HTTP/1."; nocase; fast_pattern; classtype:bad-unknown; sid:2032168; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_18, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_03_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Request for EXE via GO HTTP Client"; flow:established,to_server; http.request_line; content:".exe HTTP/"; http.user_agent; content:"Go-http-client/"; startswith; classtype:misc-activity; sid:2032355; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_03_31, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_03_31;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Control Panel Applet File Download"; flow:established,to_client; flowbits:isset,ET.http.binary; content:"CPlApplet"; fast_pattern; reference:url,msdn.microsoft.com/en-us/library/windows/desktop/bb776392%28v=vs.85%29.aspx; reference:url,www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-cpl-malware.pdf; classtype:policy-violation; sid:2018087; rev:3; metadata:created_at 2014_02_07, updated_at 2021_04_02;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Killbot JS Configuration - Possible Phishing"; flow:established,to_client; file.data; content:"const killbot"; nocase; content:"apiKey|3a|"; nocase; content:"botRedirection|3a|"; nocase; content:"killbot-security.js"; nocase; fast_pattern; reference:url,killbot.org; classtype:misc-activity; sid:2032468; rev:2; metadata:affected_product Web_Server_Applications, attack_target Client_Endpoint, created_at 2021_04_05, deployment Perimeter, former_category INFO, signature_severity Critical, tag Phishing, updated_at 2021_04_05, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1566, mitre_technique_name Phishing;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to DDNS Domain .myfirewall .org"; dns.query; content:".myfirewall.org"; endswith; fast_pattern; classtype:bad-unknown; sid:2032792; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_04_21, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_04_21;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.addns .org Domain"; dns.query; content:".addns.org"; endswith; classtype:bad-unknown; sid:2032896; rev:1; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2021_05_04, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_05_04;)

alert tcp-pkt any any -> [$HOME_NET,$HTTP_SERVERS,$SMTP_SERVERS] any (msg:"ET INFO Possible Overflow Attempt - Abnormally Large SMTP EHLO Inbound"; flow:established,to_server; content:"EHLO"; startswith; isdataat:1000,relative; classtype:bad-unknown; sid:2032926; rev:2; metadata:attack_target SMTP_Server, created_at 2021_05_10, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_05_11;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.date domain"; flow:established,to_server; http.host; content:".date"; fast_pattern; endswith; classtype:bad-unknown; sid:2032983; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.cam domain"; flow:established,to_server; http.host; content:".cam"; fast_pattern; endswith; classtype:bad-unknown; sid:2032984; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.surf domain"; flow:established,to_server; http.host; content:".surf"; fast_pattern; endswith; classtype:bad-unknown; sid:2032985; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.asia domain"; flow:established,to_server; http.host; content:".asia"; fast_pattern; endswith; classtype:bad-unknown; sid:2032986; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.tw domain"; flow:established,to_server; http.host; content:".tw"; fast_pattern; endswith; classtype:bad-unknown; sid:2032987; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.ml domain"; flow:established,to_server; http.host; content:".ml"; fast_pattern; endswith; classtype:bad-unknown; sid:2032988; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.gq domain"; flow:established,to_server; http.host; content:".gq"; fast_pattern; endswith; classtype:bad-unknown; sid:2032989; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.ga domain"; flow:established,to_server; http.host; content:".ga"; fast_pattern; endswith; classtype:bad-unknown; sid:2032990; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO HTTP Request to a *.buzz domain"; flow:established,to_server; http.host; content:".buzz"; fast_pattern; endswith; classtype:bad-unknown; sid:2032991; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_05_18, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_05_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO POST to Double Slash in URI"; flow:established,to_server; http.request_line; content:"POST|20|//|20|HTTP/1."; startswith; http.header_names; content:!"Referer"; classtype:bad-unknown; sid:2033045; rev:2; metadata:affected_product Any, attack_target Client_Endpoint, created_at 2021_05_28, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_05_28;)

alert udp $HOME_NET any -> $EXTERNAL_NET :1024 (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Request On Non-Standard Low Port)"; content:"|00 01|"; depth:2; content:"|21 12 a4 42|"; distance:2; within:4; reference:url,tools.ietf.org/html/rfc5389; classtype:attempted-user; sid:2033077; rev:1; metadata:created_at 2021_06_03, former_category INFO, updated_at 2021_06_03;)

alert udp $HOME_NET any -> $EXTERNAL_NET [!3478,1023:] (msg:"ET INFO Session Traversal Utilities for NAT (STUN Binding Request On Non-Standard High Port)"; content:"|00 01|"; depth:2; content:"|21 12 a4 42|"; distance:2; within:4; reference:url,tools.ietf.org/html/rfc5389; classtype:attempted-user; sid:2033078; rev:2; metadata:created_at 2021_06_03, updated_at 2021_06_03;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Unix/Linux Processhider Source Being Downloaded"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/d/processhider.c"; bsize:17; fast_pattern; http.user_agent; content:"curl/"; startswith; http.host; content:"m.windowsupdatesupport.org"; bsize:26; reference:md5,4ff3828a2ecc6314bfc7dc22ca194480; reference:url,twitter.com/JAMESWT_MHT/status/1402239031602302983; classtype:bad-unknown; sid:2033117; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_06_08, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_06_08;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to DDNS Domain .dns1 .us"; dns.query; content:".dns1.us"; endswith; fast_pattern; classtype:bad-unknown; sid:2033119; rev:1; metadata:created_at 2021_06_09, updated_at 2021_06_09;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to DDNS Domain .otzo .com"; dns.query; content:".otzo.com"; endswith; fast_pattern; classtype:bad-unknown; sid:2033120; rev:1; metadata:created_at 2021_06_09, updated_at 2021_06_09;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to DDNS Domain .zyns .com"; dns.query; content:".zyns.com"; endswith; fast_pattern; classtype:bad-unknown; sid:2033121; rev:1; metadata:created_at 2021_06_09, updated_at 2021_06_09;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to DDNS Domain .zzux .com"; dns.query; content:".zzux.com"; endswith; fast_pattern; classtype:bad-unknown; sid:2033122; rev:1; metadata:created_at 2021_06_09, updated_at 2021_06_09;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Ransomware Decryptor Domain in DNS Query (decryptor .top)"; dns.query; content:"decryptor.top"; nocase; bsize:13; reference:url,tria.ge/191216-4rcmytrrka; classtype:domain-c2; sid:2033201; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_06_29, deployment Perimeter, former_category INFO, signature_severity Major, tag Ransomware, updated_at 2021_06_29, mitre_tactic_id TA0040, mitre_tactic_name Impact, mitre_technique_id T1486, mitre_technique_name Data_Encrypted_for_Impact;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Ransomware Decryptor Domain in  DNS Query (decoder .re)"; dns.query; content:"decoder.re"; nocase; bsize:10; classtype:domain-c2; sid:2033202; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_06_29, deployment Perimeter, former_category INFO, signature_severity Major, tag Ransomware, updated_at 2021_06_29, mitre_tactic_id TA0040, mitre_tactic_name Impact, mitre_technique_id T1486, mitre_technique_name Data_Encrypted_for_Impact;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Observed External IP Lookup Domain (api .2ip .ua in TLS SNI)"; flow:established,to_server; tls.sni; content:"api.2ip.ua"; bsize:10; fast_pattern; classtype:bad-unknown; sid:2033214; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_07_01, deployment Perimeter, performance_impact Low, signature_severity Informational, updated_at 2021_07_01;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO URL Shortening Service Domain in TLS SNI (coki .me)"; flow:established,to_server; tls.sni; content:"coki.me"; bsize:7; fast_pattern; classtype:bad-unknown; sid:2033267; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_07_07, deployment Perimeter, former_category INFO, signature_severity Major, tag SSL_Malicious_Cert, updated_at 2021_07_07;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO URL Shortening Service Domain in TLS SNI (hyp .ae)"; flow:established,to_server; tls.sni; content:"hyp.ae"; bsize:6; fast_pattern; classtype:policy-violation; sid:2033288; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_07_09, deployment Perimeter, former_category INFO, signature_severity Major, tag SSL_Malicious_Cert, updated_at 2021_07_09;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Windows Powershell User-Agent Usage"; flow:established,to_server; http.user_agent; content:"Mozilla/"; startswith; content:") WindowsPowerShell/"; distance:0; fast_pattern; classtype:not-suspicious; sid:2033355; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_07_16, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_07_16;)

alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to freemyip .com Domain"; dns.query; content:".freemyip.com"; nocase; endswith; classtype:bad-unknown; sid:2033365; rev:2; metadata:attack_target Client_Endpoint, created_at 2021_07_20, deployment Perimeter, former_category POLICY, performance_impact Low, signature_severity Informational, updated_at 2021_07_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possible Sharepoint Resource Infection"; flow:established,to_client; http.response_line; content:"HTTP/1.1|20|409|20|CONFLICT"; http.header; content:"|0d 0a|x-virus-infected|3a 20|"; content:"-location|3a 20|"; distance:0; reference:url,docs.microsoft.com/en-us/openspecs/sharepoint_protocols/ms-wsshp/ba4ee7a8-704c-4e9c-ab14-fa44c574bdf4; classtype:bad-unknown; sid:2033698; rev:1; metadata:attack_target Client_and_Server, created_at 2021_08_10, deployment Perimeter, deployment SSLDecrypt, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_08_10;)

alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET INFO Pulse Secure VPN Version Disclosure Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/dana-admin/misc/admin.cgi"; fast_pattern; classtype:attempted-recon; sid:2033749; rev:1; metadata:affected_product Pulse_Secure, created_at 2021_08_20, former_category INFO, updated_at 2021_08_20;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Suspicious Shellcode Request"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/shellcode/"; fast_pattern; startswith; content:".txt"; endswith; http.host; pcre:"/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/"; http.user_agent; content:"python-requests/"; http.header_names; content:!"|0d 0a|Referer|0d 0a|"; reference:md5,8f21b629ef0aa2558962644a4a1605ca; classtype:bad-unknown; sid:2033844; rev:2; metadata:attack_target Client_Endpoint, created_at 2021_08_30, deployment Perimeter, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_08_30;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Office Retrieving .rtf (GET)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".rtf"; endswith; fast_pattern; http.user_agent; content:"|3b 20|ms-office|3b 20|"; http.header_names; content:!"Referer"; reference:url,twitter.com/ShadowChasing1/status/1433038639961804800; reference:md5,c9f8addb927c3b96aee6a9f671a1f801; classtype:bad-unknown; sid:2033858; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_09_01, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_09_01;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Lockbit Ransomware Related Domain in DNS Lookup (decoding .at)"; dns.query; content:"decoding.at"; nocase; bsize:11; fast_pattern; reference:url,unit42.paloaltonetworks.com/emerging-ransomware-groups/; classtype:bad-unknown; sid:2033860; rev:2; metadata:attack_target Client_Endpoint, created_at 2021_09_01, deployment Perimeter, former_category INFO, signature_severity Major, tag Ransomware, updated_at 2021_09_01, mitre_tactic_id TA0040, mitre_tactic_name Impact, mitre_technique_id T1486, mitre_technique_name Data_Encrypted_for_Impact;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Lockbit Ransomware Related Domain in DNS Lookup (bigblog .at)"; dns.query; content:"bigblog.at"; nocase; bsize:10; fast_pattern; reference:url,unit42.paloaltonetworks.com/emerging-ransomware-groups/; classtype:bad-unknown; sid:2033861; rev:2; metadata:attack_target Client_Endpoint, created_at 2021_09_01, deployment Perimeter, former_category INFO, signature_severity Major, tag Ransomware, updated_at 2021_09_01, mitre_tactic_id TA0040, mitre_tactic_name Impact, mitre_technique_id T1486, mitre_technique_name Data_Encrypted_for_Impact;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Lockbit Ransomware Related Domain in DNS Lookup (lockbit-decryptor .com)"; dns.query; content:"lockbit-decryptor.com"; nocase; bsize:21; fast_pattern; reference:url,unit42.paloaltonetworks.com/emerging-ransomware-groups/; reference:md5,5b741c6abf44d2eecd853addeafdcf24; classtype:bad-unknown; sid:2033862; rev:2; metadata:attack_target Client_Endpoint, created_at 2021_09_01, deployment Perimeter, former_category INFO, signature_severity Major, tag Ransomware, updated_at 2021_09_01, mitre_tactic_id TA0040, mitre_tactic_name Impact, mitre_technique_id T1486, mitre_technique_name Data_Encrypted_for_Impact;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Lockbit Ransomware Related Domain in DNS Lookup (lockbit-decryptor .top)"; dns.query; content:"lockbit-decryptor.top"; nocase; bsize:21; fast_pattern; reference:url,unit42.paloaltonetworks.com/emerging-ransomware-groups/; reference:md5,69bec32d50744293e85606a5e8f80425; classtype:bad-unknown; sid:2033863; rev:2; metadata:attack_target Client_Endpoint, created_at 2021_09_01, deployment Perimeter, former_category INFO, signature_severity Major, tag Ransomware, updated_at 2021_09_01, mitre_tactic_id TA0040, mitre_tactic_name Impact, mitre_technique_id T1486, mitre_technique_name Data_Encrypted_for_Impact;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Observed Blockchain Domain (api .blockcypher .com in TLS SNI)"; flow:established,to_server; tls.sni; content:"api.blockcypher.com"; bsize:19; fast_pattern; classtype:bad-unknown; sid:2033877; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_09_02, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_09_02;)

alert tls any [5986,5985,1270] -> any any (msg:"ET INFO Possible Microsoft OMI Agent Default TLS Certificate Observed"; flow:established,to_client; tls.cert_subject; content:"cloudapp.net"; tls.cert_issuer; content:".cloudapp.net"; reference:url,attackerkb.com/topics/08O94gYdF1/cve-2021-38647; reference:url,msrc.microsoft.com/update-guide/vulnerability/CVE-2021-38647; reference:url,www.wiz.io/blog/secret-agent-exposes-azure-customers-to-unauthorized-code-execution; classtype:bad-unknown; sid:2033955; rev:2; metadata:attack_target Server, created_at 2021_09_15, deployment Perimeter, deployment Internet, former_category POLICY, signature_severity Informational, updated_at 2021_09_15;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Outdated Browser Landing Page M3"; flow:established,to_client;http.stat_code; content:"200"; file.data; content:"!|5c|n|5c|nWebsite work well"; fast_pattern; nocase; reference:url,blog.group-ib.com/perswaysion; classtype:misc-activity; sid:2033998; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_09_21, deployment Perimeter, former_category PHISHING, signature_severity Major, updated_at 2021_09_22;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Outdated Browser Landing Page M2"; flow:established,to_client; http.stat_code; content:"200"; file.data; content:"|5c|nUpdate your browser"; nocase; content:"is out-of-date"; fast_pattern; nocase; reference:url,blog.group-ib.com/perswaysion; classtype:misc-activity; sid:2033997; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_09_21, deployment Perimeter, former_category PHISHING, signature_severity Minor, updated_at 2021_09_22;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET INFO Possible Outdated Browser Landing Page M1"; flow:established,to_client; http.stat_code; content:"200"; file.data; content:"Your browser is"; nocase; fast_pattern; content:"work well in"; nocase; distance:0; content:"your browser to view this"; nocase; distance:0; reference:url,blog.group-ib.com/perswaysion; classtype:misc-activity; sid:2033996; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_09_21, deployment Perimeter, former_category PHISHING, signature_severity Minor, updated_at 2021_09_22;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Microsoft Netconnection Domain in DNS Lookup"; dns.query; content:"internetbeacon.msedge.net"; fast_pattern; nocase; bsize:25; reference:url,lazyadmin.nl/powershell/test-netconnection/; classtype:bad-unknown; sid:2034025; rev:2; metadata:created_at 2021_09_24, former_category INFO, updated_at 2021_09_24;)

#alert tcp any any -> any any (msg:"ET INFO HTTP/2 Traffic (SET)"; flow:established,to_server; stream_size:server,<,5; content:"|50 52 49 20 2a 20 48 54 54 50 2f 32 2e 30 0d 0a 0d 0a 53 4d 0d 0a 0d 0a|"; startswith; flowbits:set,ET.http2; flowbits:noalert; classtype:misc-activity; sid:2034094; rev:2; metadata:created_at 2021_10_04, former_category INFO, updated_at 2021_10_04;)

alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET INFO Suspicious POST to Axis OS (smtptest.cgi)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/axis-cgi/smtptest.cgi"; fast_pattern; reference:url,nozominetworks.com/blog/new-axis-os-security-research-aided-by-transparent-design/; reference:cve,2021-31986; classtype:attempted-admin; sid:2034130; rev:1; metadata:attack_target Server, created_at 2021_10_06, deployment Perimeter, deployment Internal, former_category INFO, performance_impact Low, signature_severity Informational, updated_at 2021_10_06;)

alert dns $HOME_NET any -> any any (msg:"ET INFO External IP Lookup Domain DNS Lookup (my-ip .io)"; dns.query; dotprefix; content:".my-ip.io"; nocase; endswith; classtype:bad-unknown; sid:2034196; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_10_15, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_10_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Interactsh Domain in DNS Lookup (.interact .sh)"; dns.query; dotprefix; content:".interact.sh"; nocase; endswith; reference:url,unit42.paloaltonetworks.com/exploits-interactsh/; classtype:bad-unknown; sid:2034198; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_10_15, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_10_15;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Outbound .png HTTP GET flowbit set"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".png"; endswith; flowbits:set,ET.httpget.png; flowbits:noalert; classtype:misc-activity; sid:2034212; rev:1; metadata:created_at 2021_10_18, former_category INFO, updated_at 2021_10_18;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Fake AppleWebKit User-Agent Version Number Observed"; flow:established,to_server; http.user_agent; content:"AppleWebKit/"; fast_pattern; byte_test:3,>,605,0,string,dec,relative; reference:url,bugs.webkit.org/show_bug.cgi?id=180365; classtype:bad-unknown; sid:2034228; rev:1; metadata:created_at 2021_10_19, former_category INFO, updated_at 2021_10_19;)

alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET INFO Possible GoCD Authentication Bypass URI Path - add-on"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/add-on/"; nocase; fast_pattern; reference:url,blog.sonarsource.com/gocd-pre-auth-pipeline-takeover; classtype:attempted-admin; sid:2034330; rev:1; metadata:attack_target Server, created_at 2021_11_02, deployment Perimeter, deployment Internal, former_category INFO, signature_severity Major, tag Exploit, updated_at 2021_11_02;)

alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET INFO Possible GoCD Authentication Bypass URI Path - cruise_config"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/cruise_config"; nocase; fast_pattern; flowbits:set,ET.gocd.auth; reference:url,blog.sonarsource.com/gocd-pre-auth-pipeline-takeover; classtype:attempted-admin; sid:2034332; rev:1; metadata:attack_target Server, created_at 2021_11_02, deployment Perimeter, deployment Internal, former_category INFO, signature_severity Major, tag Exploit, updated_at 2021_11_02;)

alert http $HOME_NET any -> $EXTERNAL_NET 30003 (msg:"ET INFO Observed Initial NKN POST Request"; flow:established,to_server; http.request_line; content:"POST|20|/|20|HTTP/1.1"; http.host.raw; content:"seed.nkn.org|3a|"; startswith; fast_pattern; http.user_agent; content:"Go-http-client/"; startswith; http.request_body; content:"{|22|id|22 3a 22|"; reference:md5,aedebba95462e9db10b834551e3abc03; classtype:policy-violation; sid:2034414; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_11_10, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_11_10;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Observed DNS Query to Commonly Abused Preview Domain (preview-domain .com)"; dns.query; dotprefix; content:".preview-domain.com"; nocase; endswith; classtype:bad-unknown; sid:2034561; rev:1; metadata:attack_target Client_Endpoint, created_at 2021_11_30, deployment Perimeter, former_category INFO, signature_severity Major, updated_at 2021_11_30;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO webhook .site in TLS SNI"; flow:established,to_server; tls.sni; content:"webhook.site"; endswith; nocase; reference:md5,58f8070803608bd0bd2cb6b18351918e; reference:url,isc.sans.edu/forums/diary/InfoStealer+Using+webhooksite+to+Exfiltrate+Data/28088/; classtype:misc-activity; sid:2034634; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_12_08, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2021_12_08;)

alert http $HOME_NET any -> any any (msg:"ET INFO Python BaseHTTP ServerBanner"; flow:established; http.server; content:"BaseHTTP/"; startswith;content:"Python/"; distance:0;  reference:url,wiki.python.org/moin/BaseHttpServer; classtype:misc-activity; sid:2034635; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_12_08, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2021_12_08;)

alert http $HOME_NET any -> any any (msg:"ET INFO Python SimpleHTTP ServerBanner"; flow:established; http.server; content:"SimpleHTTP/"; startswith; content:"Python/"; distance:0; reference:url,wiki.python.org/moin/BaseHttpServer; classtype:misc-activity; sid:2034636; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_12_08, deployment Perimeter, former_category INFO, signature_severity Minor, updated_at 2021_12_08;)

alert dns $HOME_NET any -> any any (msg:"ET INFO Interactsh Domain in DNS Lookup (.interactsh .com)"; dns.query; dotprefix; content:".interactsh.com"; nocase; endswith; reference:url,unit42.paloaltonetworks.com/exploits-interactsh/; classtype:bad-unknown; sid:2034732; rev:2; metadata:attack_target Client_Endpoint, created_at 2021_12_15, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_12_15;)

alert dns $HOME_NET any -> any any (msg:"ET INFO URL Shortner Domain in DNS Lookup (urlz .fr)"; dns.query; content:"urlz.fr"; nocase; bsize:7; reference:md5,947c34579e51417d9290c0cd8475cc54; classtype:bad-unknown; sid:2034742; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2021_12_15, deployment Perimeter, former_category INFO, signature_severity Informational, updated_at 2021_12_15;)

